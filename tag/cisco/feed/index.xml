<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>cisco &#8211; RSNET.PL</title>
	<atom:link href="https://kubsoo.github.io/rsnet-website/tag/cisco/feed/" rel="self" type="application/rss+xml" />
	<link>https://kubsoo.github.io/rsnet-website/</link>
	<description>wszystko o sieciach komputerowych</description>
	<lastBuildDate>Sat, 22 Feb 2020 11:40:47 +0000</lastBuildDate>
	<language>pl-PL</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.9.8</generator>
	<item>
		<title>Spanning Tree Protocol &#8211; podstawy</title>
		<link>https://kubsoo.github.io/rsnet-website/bgp-wyrazenia-regularne-2/</link>
		<pubDate>Wed, 15 Aug 2018 22:13:46 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[podstawy]]></category>
		<category><![CDATA[spanning tree protocol]]></category>
		<category><![CDATA[stp]]></category>
		<category><![CDATA[switching]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=1114</guid>
		<description><![CDATA[Protokół drzewa rozpinającego (STP) został przedstawiony jako mechanizm przeciwdziałania pętlą w warstwie drugiej modelu ISO/OSI. STP używa mechanizmu, który polega na wyłączaniu redundantnych linków w celu uniknięcia pętli w sieci&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify;"><span style="color: #000000;">Protokół drzewa rozpinającego (STP) został przedstawiony jako mechanizm przeciwdziałania pętlą w warstwie drugiej modelu ISO/OSI. STP używa mechanizmu, który polega na wyłączaniu redundantnych linków w celu uniknięcia pętli w sieci LAN. Gdyby nie STP pakiety rozgłoszeniowe (Broadcast) krążyły by w sieci w nieskończoność.</span></p>
<p><span style="color: #000000;">Załóżmy, że mamy poniższą topologię sieci przedstawioną na rysunku poniżej.</span></p>
<p>&nbsp;</p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_1.png" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1115 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_1.png" alt="" width="580" height="440" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_1.png 580w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_1-300x228.png 300w" sizes="(max-width: 580px) 100vw, 580px" /></a></p>
<p style="text-align: justify;"><span style="color: #000000;">PC-1 chcę się skomunikować z PC-2, załóżmy że na PC-1 wydamy komendę ping 192.168.0.2. Host PC-1 nie zna adresu MAC hosta PC-2, więc musi wysłać zapytanie</span> <a href="https://pl.wikipedia.org/wiki/Address_Resolution_Protocol" title="">ARP</a> <span style="color: #000000;">na adres rozgłoszeniowy. Ramka z tym zapytaniem trafia najpierw do switcha SW3, który przesyła ją do wszystkich swoich interfejsów (Gi0/0, Gi0/1), z wyjątkiem interfejsu z którego ta ramka przyszła (Gi0/2). Następnie ramka dociera do SW1 oraz do SW2. Oba te switche również przesyłają tą ramkę w taki sam sposób jak zrobił to SW3, czyli SW1 przesyła ramkę przez Gi0/1 w kierunku SW2, oraz przez Gi0/2 do PC-2, natomiast SW2 przesyła ramkę przez Gi0/0 w kierunku SW1. Host PC-2 otrzymał zapytanie ARP i może na nie odpowiedzieć, jednak ramka z zapytaniem dalej krąży pomiędzy SW1, SW2 i SW3 i będzie tak krążyć w nieskończoność. Jedynym sposobem na przerwanie tej pętli jest wyłączenie jednego z interfejsów pomiędzy switchami, w taki sposób żeby istniała tylko jedna ścieżka pomiędzy PC-1 a PC-2 i do tego właśnie celu służy protokół drzewa rozpinającego (Spanning Tree Protocol).</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Domyślnie przełączniki Cisco mają uruchomiony protokół STP, natomiast dla celów zobrazowania co się stanie jak w sieci LAN powstanie pętla i ramki będą krążyć w nieskończoność wyłączymy STP na switchach w topologii przedstawionej powyżej.  Sprawdźmy co się stanie z przełącznikami jak wyłaczymy STP i wykonamy ping z PC-1 na PC-2.</span></p>
<p><span style="color: #000000;">Do wyłączenia STP służy komenda:</span></p>
<pre><span style="color: #000000;">SW(config)# no spanning-tree vlan 1</span></pre>
<p style="text-align: justify;"><span style="color: #000000;">Wykonajmy ją na wszystkich trzech switchach:</span></p>
<pre><span style="color: #000000;">SW1(config)# no spanning-tree vlan 1
SW2(config)# no spanning-tree vlan 1
SW3(config)# no spanning-tree vlan 1</span></pre>
<p style="text-align: justify;"><span style="color: #000000;">Teraz wykonajmy ping z PC-1 i PC-2 i obserwujmy co się stanie. Switche SW1 i SW2 przestały odpowiadać na komendy, utylizacja procesora jest na bardzo wysokim poziomie, dlatego nie odpowiada konsola, dodatkowo jak uruchomimy wiresharka na jednym z interfejsów pomiędzy switchami to zobaczymy, że cały czas krążą w sieci pakiety broadcast:</span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_2.png" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1118 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_2.png" alt="" width="974" height="438" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_2.png 974w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_2-300x135.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_2-768x345.png 768w" sizes="(max-width: 974px) 100vw, 974px" /></a></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Dodatkowo ping pomiędzy PC-1 a PC-2 nie działa, dostajemy timeout i jest to spowodowane pętlą w sieci. Wyłączmy teraz jeden z interfejsów switcha SW3 (Gi0/1) i zobaczmy jak będzie wyglądała sytuacja. Od razu po wyłączeniu interfejsu Gi0/1 możemy zaobserwować, że konsole na switchach zaczęły odpowiadać, oraz ping z PC-1 na PC-2 działa.</span></p>
<pre><span style="color: #000000;">VPCS&gt; ping 192.168.0.2
84 bytes from 192.168.0.2 icmp_seq=1 ttl=64 time=9.095 ms
84 bytes from 192.168.0.2 icmp_seq=2 ttl=64 time=15.457 ms
84 bytes from 192.168.0.2 icmp_seq=3 ttl=64 time=27.437 ms
84 bytes from 192.168.0.2 icmp_seq=4 ttl=64 time=12.474 ms
84 bytes from 192.168.0.2 icmp_seq=5 ttl=64 time=11.474 ms</span></pre>
<p>&nbsp;</p>
<p><span style="color: #000000;"><strong>Jak działa STP ?</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Włączmy teraz spowrotem na switchach spanning-tree protocol oraz interfejs który wyłączyliśmy.  W celu weryfikacji czy STP jest uruchomione możemy posłużyć się następującą komendą:</span></p>
<pre><span style="color: #000000;">SW1#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           Cost 4
           Port 1 (GigabitEthernet0/0)
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0dc1.2f00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Root FWD 4    128.1    P2p
Gi0/1     Altn BLK 4    128.2    P2p</span></pre>
<pre><span style="color: #000000;">SW2#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           Cost 4
           Port 2 (GigabitEthernet0/1)
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0d8e.9c00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Desg FWD 4    128.1    P2p
Gi0/1     Root FWD 4    128.2    P2p
Gi0/2     Desg FWD 4    128.3    P2p</span></pre>
<pre><span style="color: #000000;">SW3#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           This bridge is the root
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0d3f.0c00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Desg FWD 4    128.1    P2p
Gi0/1     Desg FWD 4    128.2    P2p
Gi0/2     Desg FWD 4    128.3    P2p</span></pre>
<p style="text-align: justify;"><span style="color: #000000;">Protokół STP działa w oparciu o ramki BPDU (bridge protocol data unit). Switche wymieniają się tymi ramkami i na ich podstawie ustalają które nadmiarowe połączenia zablokować. Ramka BPDU wygląda następująco:</span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_3.png" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1124 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_3.png" alt="" width="542" height="470" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_3.png 542w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_3-300x260.png 300w" sizes="(max-width: 542px) 100vw, 542px" /></a></span></p>
<p><span style="color: #000000;">Najpierw na podstawie ramek BPDU wybierany jest korzeń drzewa (root bridge). Korzeń drzewa zostaje wybrany na podstawie Bridge Identifier, które składa się następujących pól:</span></p>
<p style="padding-left: 30px;"><span style="color: #000000;">Bridge Priority &#8211; priorytet przełacznika</span></p>
<p style="padding-left: 30px;"><span style="color: #000000;">Bridge System ID Extension &#8211; vlan dla którego działa STP</span></p>
<p style="padding-left: 30px;"><span style="color: #000000;">Bridge System ID &#8211; MAC adres przełącznika</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Root Bridge zostaje switch który posiada najmniejszy priorytet, w przypadku gdy priorytety są takie same to korzeniem zostaje przełącznik o najniższym adresie MAC. W naszym przykładzie Root Bridge został wybrany switch SW3, ponieważ posiada najniższy MAC adres (priorytety na wszystkich switchach są takie same)</span></p>
<pre><span style="color: #000000;">SW1 Bridge ID 
Priority <strong>32769</strong> (priority 32768 sys-id-ext 1) 
Address <strong>00ca.0dc1.2f00</strong></span></pre>
<pre><span style="color: #000000;">SW2 Bridge ID 
Priority <strong>32769</strong> (priority 32768 sys-id-ext 1)
Address <strong>00ca.0d8e.9c00</strong>

SW3 Bridge ID
Priority <strong>32769</strong> (priority 32768 sys-id-ext 1)
Address <strong>00ca.0d3f.0c00</strong></span></pre>
<p><span style="color: #000000;">Zweryfikujmy to wydając komendę show spanning-tree na SW3:</span></p>
<pre><span style="color: #000000;">SW3#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID Priority 32769
        Address 00ca.0d3f.0c00
<strong>        This bridge is the root</strong>
        Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID Priority 32769 (priority 32768 sys-id-ext 1)
          Address 00ca.0d3f.0c00
          Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
          Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Desg FWD 4    128.1    P2p
Gi0/1     Desg FWD 4    128.2    P2p
Gi0/2     Desg FWD 4    128.3    P2p</span></pre>
<p>&nbsp;</p>
<p style="text-align: justify;"><span style="color: #000000;">Następny krok po wybraniu root bridge to ustawienie portów przełączników w odpowiedniej roli. Role portów w STP są trzy: Designated, Root, Alternate. Porty Designated i Root przesyłają ruch, natomiast porty Alternate są zablokowane tak aby nie powstała pętla. Porty Root są to porty które prowadzą do Root Bridge&#8217;a, natomiast porty Designated to porty które prowadzą do innych przełączników. Wszystkie porty root bridge są portami Designated:</span></p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_4-1.png" data-rel="lightbox-image-3" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1132 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_4-1.png" alt="" width="334" height="261" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_4-1.png 334w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_4-1-300x234.png 300w" sizes="(max-width: 334px) 100vw, 334px" /></a></p>
<p>&nbsp;</p>
<p style="text-align: justify;"><span style="color: #000000;">Następnie pozostałe przełączniki wybierają porty Root i Designated, które wybierane są zgodnie z poniższym algorytmem:</span></p>
<p style="text-align: justify;"><span style="color: #000000;">1. Najniższy root bridge ID</span></p>
<p style="text-align: justify;"><span style="color: #000000;">2. Najniższy koszt ścieżki do root bridge</span></p>
<p style="text-align: justify;"><span style="color: #000000;">3. Najniższy bridge ID</span></p>
<p style="text-align: justify;"><span style="color: #000000;">4. Najniższy port ID (nadawcy). </span></p>
<p style="text-align: justify;"><span style="color: #000000;">Port ID składa się z priorytetu i numeru interfejsu. W wyniku polecenia show spanning-tree jest to pole Prio.Nbr. </span></p>
<p>&nbsp;</p>
<p style="text-align: justify;"><span style="color: #000000;">Pierwszy punkt możemy ominąć, ponieważ ma on zastosowanie tylko dla portów Root Bridge&#8217;a. Kolejny punkt to najniższy koszt ścieżki do root bridge. Domyślnie koszty portów wyglądają następująco:</span></p>
<table style="border-collapse: collapse; width: 52.0086%; height: 120px;" border="1">
<tbody>
<tr style="height: 24px;">
<td style="width: 38.9212%; height: 24px;"><span style="color: #000000;"><strong>Pasmo</strong></span></td>
<td style="width: 24.3023%; height: 24px;"><span style="color: #000000;"><strong>Koszt</strong></span></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.9212%; height: 24px;"><span style="color: #000000;">10 Mbps</span></td>
<td style="width: 24.3023%; height: 24px;"><span style="color: #000000;">100</span></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.9212%; height: 24px;"><span style="color: #000000;">100 Mbps</span></td>
<td style="width: 24.3023%; height: 24px;"><span style="color: #000000;">19</span></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.9212%; height: 24px;"><span style="color: #000000;">1-Gigabit Ethernet</span></td>
<td style="width: 24.3023%; height: 24px;"><span style="color: #000000;">4</span></td>
</tr>
<tr style="height: 24px;">
<td style="width: 38.9212%; height: 24px;"><span style="color: #000000;">10-Gigabit Ethernet</span></td>
<td style="width: 24.3023%; height: 24px;"><span style="color: #000000;">2</span></td>
</tr>
</tbody>
</table>
<p style="text-align: justify;"><span style="color: #000000;">W naszej topologii mamy interfejsy Gigabitowe więc koszty poszczególnych linków wynoszą 4:</span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_6.png" data-rel="lightbox-image-4" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1138 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_6.png" alt="" width="334" height="261" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_6.png 334w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_6-300x234.png 300w" sizes="(max-width: 334px) 100vw, 334px" /></a></span></p>
<p><span style="color: #000000;">Dla SW1 koszt ścieżki do Root Bridge przez Gi0/0 wynosi 4, natomiast przez Gi0/1 wynosi 4+4 czyli 8. W związku z tym Gi0/0 zostanie Root Port. </span></p>
<p><span style="color: #000000;">Dla SW2 koszt ścieżki do Root Bridge przez Gi0/0 wynosi 4 +4 czyli 8, natomiast przez Gi0/1 wynosi 4. W związku z tym Gi0/1 zostanie Root Port.</span></p>
<p>&nbsp;</p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_7.png" data-rel="lightbox-image-5" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1139 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_7.png" alt="" width="334" height="261" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_7.png 334w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_7-300x234.png 300w" sizes="(max-width: 334px) 100vw, 334px" /></a></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Ostatni krok to wybór portu Designated i portu Alternate. W obu przypadkach zarówno port Gi0/1 na SW1 oraz Gi0/0 na SW2 mają ten sam koszt ścieżki do Root Bridge, dlatego musimy wziąć następny punkt algorytmu wyboru, czyli punkt 3. Najniższy bridge ID. Dla przypomnienia Bridge ID SW1 = 32769 + 00ca.0d<strong>c</strong>1.2f00, a Bridge ID SW2 = 32769 + 00ca.0d<strong>8</strong>e.9c00. Priorytet w obu przypadkach jest taki sam, czyli niższy Bridge ID jest ustalany a podstawie niższego adresu MAC, w tym przypadku SW2 ma niższy Bridge ID, czyli port Gi0/0 na SW2 zostanie portem Designated, a port Gi0/1 na switchu SW1 zostanie zablokowany, czyli będzie pełnił rolę Alternate.</span></p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_5.png" data-rel="lightbox-image-6" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-1141 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_5.png" alt="" width="334" height="261" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_5.png 334w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/08/stp_5-300x234.png 300w" sizes="(max-width: 334px) 100vw, 334px" /></a><span style="color: #000000;">Zweryfikujmy stan portów korzystając z komendy show spanning-tree.</span></p>
<pre><span style="color: #000000;">SW1#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           Cost 4
           Port 1 (GigabitEthernet0/0)
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0dc1.2f00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
<strong>Gi0/0     Root</strong> FWD 4    128.1    P2p
<strong>Gi0/1     Altn</strong> BLK 4    128.2    P2p</span></pre>
<pre><span style="color: #000000;">SW2#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           Cost 4
           Port 2 (GigabitEthernet0/1)
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0d8e.9c00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
<strong>Gi0/0     Desg</strong> FWD 4    128.1    P2p
<strong>Gi0/1     Root</strong> FWD 4    128.2    P2p
</span></pre>
<pre><span style="color: #000000;">SW3#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID    Priority 32769
           Address 00ca.0d3f.0c00
           This bridge is the root
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID  Priority 32769 (priority 32768 sys-id-ext 1)
           Address 00ca.0d3f.0c00
           Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
           Aging Time 300 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
<strong>Gi0/0     Desg</strong> FWD 4    128.1    P2p
<strong>Gi0/1     Desg</strong> FWD 4    128.2    P2p

</span></pre>
<p style="text-align: justify;"><span style="color: #000000;">Każdy z portów w STP może być w jednym z poniższych stanów:</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Disabled &#8211; port jest wyłączony administracyjnie (shutdown) i nie bierze udziału w procesie STP </span></p>
<p style="text-align: justify;"><span style="color: #000000;">Blocking &#8211; jest to początkowy stan portu, który trwa przez 20 sekund, po tym czasie port przechodzi do stanu Listening. Jeśli port nie jest portem Designated ani Root, czyli jest portem Alternate to również będzie w stanie blocking i w nim pozostanie dopóki nie zostanie zmieniona topologia sieci. Port w stanie blocking nie uczestniczy w procesie przesyłania ramek.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Listening &#8211; tylko designated i root port może przejść w stan nasłuchiwania. W tym stanie switch próbuje dowiedzieć się jak wygląda topologia. Port w stanie listening przesyła tylko ramki BPDU, ramki z danymi nie są przesyłane, po 15 sekundach w stanie listening port przechodzi w stan learning. </span></p>
<p style="text-align: justify;"><span style="color: #000000;">Learning &#8211; w tym stanie port uczy się adresów MAC poprzez analizowanie adresów źródłowych ramek ethernetowych otrzymanych na porcie. Port uczy się adresów przez 15 sekund, a następnie przechodzi w stan przesyłania ramek (Forwarding)</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Forwarding &#8211; jest to finalny stan portu, w którym następuje przesyłanie ramek z danymi.</span></p>
<p>&nbsp;</p>
<p><strong><span style="color: #000000;">STP przydatne komendy:</span></strong></p>
<ul>
<li><span style="color: #000000;">Zmiana Root Bridge</span></li>
</ul>
<p style="text-align: justify;"><span style="color: #000000;">Zmianę root bridge&#8217;a możemy wykonać na dwa sposoby. Automatycznie i ręcznie.</span></p>
<pre><span style="color: #000000;">SW1(config)#spanning-tree vlan 1 root primary</span></pre>
<p style="text-align: justify;"><span style="color: #000000;">Powyższa komenda zmieni priorytet przełącznika (bridge priority) na wartość niższą niż priorytet obecnego root bridge&#8217;a.</span></p>
<pre><span style="color: #000000;">SW1#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID     Priority 24577
            Address  00ca.0dc1.2f00
            This bridge is the root
            Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID   <strong>Priority 24577 (priority 24576 sys-id-ext 1)</strong>
            Address  00ca.0dc1.2f00
            Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
            Aging Time 15 sec

Interface Role Sts Cost Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Desg FWD 4    128.1    P2p
Gi0/1     Desg FWD 4    128.2    P2p</span></pre>
<p><span style="color: #000000;">Ręczną zmianę priorytetu możem wykonać następująca komendą:</span></p>
<pre><span style="color: #000000;">SW1(config)#spanning-tree vlan 1 priority 4096</span></pre>
<pre><span style="color: #000000;">SW1#show spanning-tree</span>

<span style="color: #000000;">VLAN0001</span>
<span style="color: #000000;">Spanning tree enabled protocol ieee</span>
<span style="color: #000000;">Root ID       <strong>Priority  4097</strong></span>
<span style="color: #000000;">              Address   00ca.0dc1.2f00</span>
<span style="color: #000000;">              This bridge is the root</span>
<span style="color: #000000;">              Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec</span>

<span style="color: #000000;">Bridge ID     <strong>Priority  4097 (priority 4096 sys-id-ext 1)</strong></span>
<span style="color: #000000;">              Address   00ca.0dc1.2f00</span>
<span style="color: #000000;">              Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec</span>
<span style="color: #000000;">              Aging Time 300 sec</span>

<span style="color: #000000;">Interface Role Sts  Cost  Prio.Nbr Type</span>
<span style="color: #000000;">------------------- ---- --- --------- -------- --------------------------------</span>
<span style="color: #000000;">Gi0/0     Desg FWD  4     128.1    P2p</span>
<span style="color: #000000;">Gi0/1     Desg FWD  4     128.2    P2p</span>

</pre>
<ul>
<li><span style="color: #000000;">Zmiana kosztu intefejsu:</span></li>
</ul>
<pre><span style="color: #000000;">SW1(config-if)#spanning-tree cost 100

SW1#show spanning-tree

VLAN0001
Spanning tree enabled protocol ieee
Root ID       Priority  4097
              Address   00ca.0dc1.2f00
              This bridge is the root
              Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec

Bridge ID    Priority   4097 (priority 4096 sys-id-ext 1)
             Address    00ca.0dc1.2f00
             Hello Time 2 sec Max Age 20 sec Forward Delay 15 sec
             Aging Time 300 sec

Interface Role Sts  Cost  Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/0     Desg FWD  <strong> 100</strong>  128.1    P2p
Gi0/1     Desg FWD   4    128.2    P2p</span></pre>
<p>&nbsp;</p>
]]></content:encoded>
			</item>
		<item>
		<title>URPF &#8211; Unicast Reverse Path Forwarding</title>
		<link>https://kubsoo.github.io/rsnet-website/urpf-unicast-reverse-path-forwarding/</link>
		<comments>https://kubsoo.github.io/rsnet-website/urpf-unicast-reverse-path-forwarding/#respond</comments>
		<pubDate>Sun, 29 Jul 2018 10:59:47 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[GNS3]]></category>
		<category><![CDATA[urpf]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=1070</guid>
		<description><![CDATA[Unicast Reverse Path Forwarding (uRPF) &#8211; jest to technika stosowana w routerach Cisco (oraz u innych producentów), która umożliwia sprawdzenie czy źródło pakietu IP jest osiągalne przez tablice routingu. Zapobiega to&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-1070">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="23e21db" class="elementor-element elementor-element-23e21db elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="3f2c616" class="elementor-element elementor-element-3f2c616 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="87211c9" class="elementor-element elementor-element-87211c9 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><div style="text-align: justify;"><strong>Unicast Reverse Path Forwarding (uRPF)</strong> &#8211; jest to technika stosowana w routerach Cisco (oraz u innych producentów), która umożliwia sprawdzenie czy źródło pakietu IP jest osiągalne przez tablice routingu. Zapobiega to fałszowaniu adresów IP (<a href="https://pl.wikipedia.org/wiki/IP_spoofing" target="_blank" rel="noopener" title="">IP spoofing</a>). uRFP może działać w dwóch trybach: &#8222;ścisłym&#8221; i &#8222;luźnym&#8221; </div><div>&#8211; strict mode</div><div>&#8211; loose mode</div><div> </div><div><b>STRICT MODE</b></div><div style="text-align: justify;"><span style="background-color: initial;">W trybie ścisłym router sprawdza czy źródłowy adres ip  pakietu otrzymanego na danym interfejsie, jest osiągalny przez router na postawie tablicy CEF FIB przez interfejs z którego przyszedł pakiet, jeśli nie to pakiet jest odrzucany.</span></div><div><span style="background-color: initial;"> </span></div><div><strong>LOOSE MODE</strong></div><div><div style="text-align: justify;">W trybie luźnym w przeciwieństwie do trybu ścisłego router sprawdza czy źródłowy adres ip pakietu otrzymanego na danym interfejsie jest osiągalny przez router na podstawie tablicy CEF FIB przez jakikolwiek z jego interfejsów.</div><div style="text-align: justify;"> </div></div></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="9dc0e5c" class="elementor-element elementor-element-9dc0e5c elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="871a84f" class="elementor-element elementor-element-871a84f elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="7302ba2" class="elementor-element elementor-element-7302ba2 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><b>PRZYKŁAD:</b></p><p style="text-align: justify;">W celu zademonstrowania działania mechanizmu uRPF w routerach CISCO posłużę się następując topologią zbudowaną w GNS3</p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="954de52" class="elementor-element elementor-element-954de52 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="b502cc9" class="elementor-element elementor-element-b502cc9 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="f62ad97" class="elementor-element elementor-element-f62ad97 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/07/urpf_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="496" height="373" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/07/urpf_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/07/urpf_1.png 496w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/07/urpf_1-300x226.png 300w" sizes="(max-width: 496px) 100vw, 496px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="1d92074" class="elementor-element elementor-element-1d92074 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="b410b8c" class="elementor-element elementor-element-b410b8c elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="b8c3b9b" class="elementor-element elementor-element-b8c3b9b elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p>Konfiguracja wygląda następująco:</p><p>R1</p><pre style="-en-clipboard: true;"><span style="background-color: initial;">interface FastEthernet0/0</span><br />  ip address 192.168.12.1 255.255.255.0<br />  ip verify unicast source reachable-via rx<br />  duplex full<br />!<br />interface FastEthernet1/0<br />  ip address 192.168.13.1 255.255.255.0<br />  duplex full<br />!<br />router ospf 1<br />  network 192.168.0.0 0.0.255.255 area 0</pre><div><p>R2</p><pre>interface Loopback0<br />  ip address 3.3.3.3 255.255.255.255<br />!<br />interface FastEthernet0/0<br />  ip address 192.168.12.2 255.255.255.0<br />  duplex full<br />!<br />interface FastEthernet1/0<br />  ip address 192.168.23.2 255.255.255.0<br />  duplex full<br />!<br />router ospf 1<br />  network 192.168.0.0 0.0.255.255 area 0</pre></div><p>R3</p><pre style="-en-clipboard: true;">interface Loopback0<br />  ip address 3.3.3.3 255.255.255.255<br />!<br />interface FastEthernet0/0<br />  ip address 192.168.13.3 255.255.255.0<br />  duplex full<br />!<br />interface FastEthernet1/0<br />  ip address 192.168.23.3 255.255.255.0<br />  duplex full<br />!<br />router ospf 1<br />  network 3.3.3.3 0.0.0.0 area 0<br />  network 192.168.0.0 0.0.255.255 area 0</pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="2f65248" class="elementor-element elementor-element-2f65248 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="17a51af" class="elementor-element elementor-element-17a51af elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="720b4ae" class="elementor-element elementor-element-720b4ae elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;">Sprawdźmy teraz jak wygląda tablica routingu na routerze R1.</p><pre>R1# show ip route<br /><br />      3.0.0.0/32 is subnetted, 1 subnets<br />O        3.3.3.3 [110/2] via 192.168.13.3, 00:06:01, FastEthernet1/0<br />      192.168.12.0/24 is variably subnetted, 2 subnets, 2 masks<br />C        192.168.12.0/24 is directly connected, FastEthernet0/0<br />L        192.168.12.1/32 is directly connected, FastEthernet0/0<br />      192.168.13.0/24 is variably subnetted, 2 subnets, 2 masks<br />C        192.168.13.0/24 is directly connected, FastEthernet1/0<br />L        192.168.13.1/32 is directly connected, FastEthernet1/0<br />O     192.168.23.0/24 [110/2] via 192.168.13.3, 00:14:33, FastEthernet1/0<br />                      [110/2] via 192.168.12.2, 00:14:33, FastEthernet0/0</pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="109ac1d" class="elementor-element elementor-element-109ac1d elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="e88f338" class="elementor-element elementor-element-e88f338 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="b6f5be7" class="elementor-element elementor-element-b6f5be7 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;">Jak widać na powyższym wyniku prefix 3.3.3.3 jest osiągalny przez interfejs FastEthernet1/0, czyli interfejsu podłączonego do routera R3. Teraz ustawmy uRPF w trybie strict na interfejsach routera R1.</p><pre>interface FastEthernet0/0<br />  ip verify unicast source reachable-via rx<br />!<br />interface FastEthernet1/0<br />  ip verify unicast source reachable-via rx</pre><p style="text-align: justify;">Przetestujmy działanie tego mechanizmu. Z routera R3 spingujmy router R1 i zobaczmy co się stanie.</p><pre>R3#ping 192.168.13.1 source 3.3.3.3<br />Type escape sequence to abort.<br />Sending 5, 100-byte ICMP Echos to 192.168.13.1, timeout is 2 seconds:<br />Packet sent with a source address of 3.3.3.3<br />!!!!!<br />Success rate is 100 percent (5/5), round-trip min/avg/max = 36/46/56 ms</pre><p style="text-align: justify;">Jak widać wszystko przebiegło bez zarzutów, ponieważ pakiet przyszedł przez interfejs FastEthernet1/0, czyli zgodnie z tablicą CEF FIB:</p><pre>R1#show ip cef 3.3.3.3<br />3.3.3.3/32<br />nexthop 192.168.13.3 FastEthernet1/0</pre><p>Sprawdzić działanie uRPF możemy wykonując polecenie:</p><pre>R1#show ip int fa0/0 | in verif<br />IP verify source reachable-via RX<br />0 verification drops<br />0 suppressed verification drops<br />0 verification drop-rate</pre><p style="text-align: justify;">Jak widać mechanizm nie odrzucił pakietów, ponieważ założenia trybu ścisłego zostały spełnione.</p><p style="text-align: justify;">Teraz spróbujmy wysłać pakiet z adresem źródłowym 3.3.3.3 przez interfejs FastEthernet0/0. Najprościej jest to zrobić z routera R2, w tym celu dodajmy interfejs Loopback0 z adresem 3.3.3.3/32 i wykonajmy polecenie ping:</p><pre>R2(config)#int Loopback 0<br />R2(config-if)#ip address 3.3.3.3 255.255.255.255<br />R2(config-if)#do ping 192.168.12.1 source 3.3.3.3<br />Type escape sequence to abort.<br />Sending 5, 100-byte ICMP Echos to 192.168.12.1, timeout is 2 seconds:<br />Packet sent with a source address of 3.3.3.3<br />.....<br />Success rate is 0 percent (0/5)
</pre><p style="text-align: justify;">Nie otrzymaliśmy odpowiedzi, sprawdźmy więc czy rzeczywiście mechanizm zadziałał:</p><pre>R1#show ip int fa0/0 | in verif<br />IP verify source reachable-via RX<br /><strong>5 verification drops</strong><br />0 suppressed verification drops<br />0 verification drop-rate</pre><p>Teraz sprawdźmy jak działa tryb luźy (loose mode). Zmieńmy konfiguracje intefejsów na R1:</p><pre>interface FastEthernet0/0<br />  ip verify unicast source reachable-via any<br />!<br />interface FastEthernet1/0<br />  ip verify unicast source reachable-via any</pre><p style="text-align: justify;">i spróbujmy wykonać jeszcze raz polecenie ping na routerze R2:</p><pre>R2#ping 192.168.12.1 source 3.3.3.3<br />Type escape sequence to abort.<br />Sending 5, 100-byte ICMP Echos to 192.168.12.1, timeout is 2 seconds:<br />Packet sent with a source address of 3.3.3.3<br />.....<br />Success rate is 0 percent (0/5)</pre><p style="text-align: justify;">Hmm, nie otrzymaliśmy odpowiedzi, czyli wynik jest taki sam jak w przypadku trybu strict, sprawdźmy to dla pewności:</p><pre>R1#show ip int fa0/0 | in verif<br />IP verify source reachable-via ANY<br />5 verification drops<br /><strong>5 suppressed verification drops</strong><br />0 verification drop-rate</pre><p style="text-align: justify;">Wynik powyższej komendy jest jednak inny niż w przypadku trybu strict. Sugeruje to, że pakiety nie zostały odrzucone i powinniśmy dostać odpowiedzi, dlaczego więc się tak nie stało ?</p><p style="text-align: justify;">Odpowiedź jest bardzo prosta (IP spoofing), ponieważ na R2 sfałszowaliśmy adres źródłowy (3.3.3.3), router R1 odesłał odpowiedzi do tego adresu, zgodnie ze swoją tablicą routingu, czyli do R3. Wykonajmy jeszcze raz to samo polecenie ping, ale włączmy tym razem debugowanie pakietów icmp na routerze R3:</p><pre>R3#debug ip icmp<br />R3#<br />*Jul 29 10:38:02.111: ICMP: echo reply rcvd, src 192.168.12.1, dst 3.3.3.3, topology BASE, dscp 0 topoid 0<br />R3#<br />*Jul 29 10:38:04.131: ICMP: echo reply rcvd, src 192.168.12.1, dst 3.3.3.3, topology BASE, dscp 0 topoid 0<br />R3#<br />*Jul 29 10:38:06.079: ICMP: echo reply rcvd, src 192.168.12.1, dst 3.3.3.3, topology BASE, dscp 0 topoid 0<br />R3#<br />*Jul 29 10:38:07.967: ICMP: echo reply rcvd, src 192.168.12.1, dst 3.3.3.3, topology BASE, dscp 0 topoid 0
</pre><p style="text-align: justify;">Czyli wszystko działa tak jak należy <img src="https://s.w.org/images/core/emoji/11/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b09d994" class="elementor-element elementor-element-b09d994 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="d2f45b6" class="elementor-element elementor-element-d2f45b6 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="4fde260" class="elementor-element elementor-element-4fde260 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><strong>PODSUMOWANIE</strong></p><p>uRFP jest jednym z mechanizmów ochrony przed fałszowaniem źródłowego adresu IP i powinno być wykorzystywane jeśli tylko jest taka możlwość. Dodatkowe komendy przydatne przy diagnozowani problemów z uRPF to:</p><pre><strong>R1#show ip traffic</strong><br />IP statistics:<br />  Rcvd:  298 total, 296 local destination<br />         0 format errors, 0 checksum errors, 0 bad hop count<br />         0 unknown protocol, 0 not a gateway<br />         0 security failures, 0 bad options, 0 with options<br />  Opts:  0 end, 0 nop, 0 basic security, 0 loose source route<br />         0 timestamp, 0 extended security, 0 record route<br />         0 stream ID, 0 strict source route, 0 alert, 0 cipso, 0 ump<br />         0 other<br />  Frags: 0 reassembled, 0 timeouts, 0 couldn't reassemble<br />         0 fragmented, 0 fragments, 0 couldn't fragment<br />  Bcast: 0 received, 0 sent<br />  Mcast: 255 received, 285 sent<br />  Sent:  332 generated, 0 forwarded<br />  Drop:  0 encapsulation failed, 0 unresolved, 0 no adjacency<br />         0 no route, 7 unicast RPF, 0 forced drop, 0 unsupported-addr<br />         0 options denied, 0 source IP address zero</pre><pre><strong>R1#show cef interface f0/0</strong><br />FastEthernet0/0 is up (if_number 2)<br />  Corresponding hwidb fast_if_number 2<br />  Corresponding hwidb firstsw-&gt;if_number 2<br />  Internet address is 192.168.12.1/24<br />  ICMP redirects are always sent<br />  Per packet load-sharing is disabled<br />  IP unicast RPF check is enabled<br />  Input features: uRPF<br />  IP policy routing is disabled<br />  BGP based policy accounting on input is disabled<br />  BGP based policy accounting on output is disabled<br />  Hardware idb is FastEthernet0/0<br />  Fast switching type 1, interface type 18<br />  IP CEF switching enabled<br />  IP CEF switching turbo vector<br />  IP CEF turbo switching turbo vector<br />  IP prefix lookup IPv4 mtrie 8-8-8-8 optimized<br />  Input fast flags 0x4000, Output fast flags 0x0<br />  ifindex 2(2)<br />  Slot  Slot unit 0 VC -1<br />  IP MTU 1500<br /><br /></pre><pre><strong>R1#show cef interface f1/0</strong><br />FastEthernet1/0 is up (if_number 3)<br />  Corresponding hwidb fast_if_number 3<br />  Corresponding hwidb firstsw-&gt;if_number 3<br />  Internet address is 192.168.13.1/24<br />  ICMP redirects are always sent<br />  Per packet load-sharing is disabled<br />  IP unicast RPF check is enabled<br />  Input features: uRPF<br />  IP policy routing is disabled<br />  BGP based policy accounting on input is disabled<br />  BGP based policy accounting on output is disabled<br />  Hardware idb is FastEthernet1/0<br />  Fast switching type 1, interface type 18<br />  IP CEF switching enabled<br />  IP CEF switching turbo vector<br />  IP CEF turbo switching turbo vector<br />  IP prefix lookup IPv4 mtrie 8-8-8-8 optimized<br />  Input fast flags 0x4000, Output fast flags 0x0<br />  ifindex 3(3)<br />  Slot  Slot unit 0 VC -1<br />  IP MTU 1500</pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/urpf-unicast-reverse-path-forwarding/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>DMVPN faza 1 + IPSEC &#8211; konfiguracja</title>
		<link>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja-2/</link>
		<comments>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja-2/#respond</comments>
		<pubDate>Tue, 02 Jan 2018 19:36:21 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Na szybko]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[dmvpn]]></category>
		<category><![CDATA[faza 1]]></category>
		<category><![CDATA[ipsec]]></category>
		<category><![CDATA[konfiguracja]]></category>
		<category><![CDATA[nhrp]]></category>
		<category><![CDATA[Poradnik]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=983</guid>
		<description><![CDATA[We wpisie https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/ pokazałem jak skonfigurować DMVPN w fazie 1 z dynamicznymi mapowaniami NHRP. W tym wpisie pokażę jak do tak przygotowanej konfiguracji dodać konfigurację IPSEC, tak żeby łączność pomiędzy urządzeniami była&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-983">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="1c79627" class="elementor-element elementor-element-1c79627 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="9c650a4" class="elementor-element elementor-element-9c650a4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="7aa1a3f" class="elementor-element elementor-element-7aa1a3f elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">We wpisie </span><span style="color: #ff0000;"><span style="background-color: initial;"><a href="https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/" title="">https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/</a> </span></span><span style="color: #000000;">pokazałem jak skonfigurować DMVPN w fazie 1 z dynamicznymi mapowaniami NHRP. W tym wpisie pokażę jak do tak przygotowanej konfiguracji dodać konfigurację IPSEC, tak żeby łączność pomiędzy urządzeniami była zabezpieczona przy wykorzystaniu IPSEC.</span></p><p><span style="color: #000000;">Przypomnijmy jeszcze raz topologię oraz konfigurację DMVPN w fazie 1 z dynamicznymi mapowaniami NHRP.</span></p><h5><span style="color: #000000;">Topologia</span></h5></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="918b75f" class="elementor-element elementor-element-918b75f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="a3ada10" class="elementor-element elementor-element-a3ada10 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="af0170c" class="elementor-element elementor-element-af0170c elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="521" height="410" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png 521w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1-300x236.png 300w" sizes="(max-width: 521px) 100vw, 521px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b91bbb2" class="elementor-element elementor-element-b91bbb2 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="24ea96d" class="elementor-element elementor-element-24ea96d elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="1cde9a9" class="elementor-element elementor-element-1cde9a9 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">Konfiguracja DMVPN</span></h5><p><span style="color: #000000;">R1</span></p><pre><span style="color: #000000;">hostname HUB</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.1 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel mode gre multipoint</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.1 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre><p><span style="color: #000000;">R2</span></p><pre><span style="color: #000000;">hostname SPOKE1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.2 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.2 255.255.255.0</span><br /><span style="color: #000000;">!<br /></span></pre><p><span style="color: #000000;">R3</span></p><pre><span style="color: #000000;">hostname SPOKE2</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.3 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.3 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre><p><span style="color: #000000;">R4</span></p><pre><span style="color: #000000;">hostname SPOKE3</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.4 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.4 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="3448fe7" class="elementor-element elementor-element-3448fe7 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="e27c1b9" class="elementor-element elementor-element-e27c1b9 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5327d05" class="elementor-element elementor-element-5327d05 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">KONFIGURACJA IPSEC</span></h5><p style="text-align: justify;"><span style="color: #000000;">Przed przystąpieniem do konfigurowania IPSEC sprawdźmy jak wygląda ruch w DMVPN widziany na interfejsie fa0/0 routera R1. Posłużymy się do tego wiresharkiem:</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="f0ff15a" class="elementor-element elementor-element-f0ff15a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="5140eb2" class="elementor-element elementor-element-5140eb2 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="7a3277c" class="elementor-element elementor-element-7a3277c elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/dmvpn_ipsec_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title="">
							<img width="531" height="387" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/dmvpn_ipsec_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/dmvpn_ipsec_1.png 531w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/dmvpn_ipsec_1-300x219.png 300w" sizes="(max-width: 531px) 100vw, 531px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b17b5e7" class="elementor-element elementor-element-b17b5e7 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="589037f" class="elementor-element elementor-element-589037f elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="c878c6c" class="elementor-element elementor-element-c878c6c elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"></div>
				</div>
				</div>
				<div data-id="8fac96c" class="elementor-element elementor-element-8fac96c elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Po uruchomieniu wiresharka spingujmy router R3 (SPOKE-2) z routera R2 (SPOKE-1). W tym celu wydajmy polecene ping 172.22.10.3 na routerze R2 (SPOKE-1).</span></p><pre><span style="color: #000000;">SPOKE1#ping 172.22.10.3</span><br /><span style="color: #000000;">Type escape sequence to abort.</span><br /><span style="color: #000000;">Sending 5, 100-byte ICMP Echos to 172.22.10.3, timeout is 2 seconds:</span><br /><span style="color: #000000;">!!!!!</span><br /><span style="color: #000000;">Success rate is 100 percent (5/5), round-trip min/avg/max = 28/40/60 ms</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="0338328" class="elementor-element elementor-element-0338328 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="7a03318" class="elementor-element elementor-element-7a03318 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="65cc2c6" class="elementor-element elementor-element-65cc2c6 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #000000;">Sprawdźmy jak wygląda ten ruch w wiresharku:</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="08f4f45" class="elementor-element elementor-element-08f4f45 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="ea272e5" class="elementor-element elementor-element-ea272e5 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="acc17e8" class="elementor-element elementor-element-acc17e8 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="360" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_1.png 927w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_1-300x150.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_1-768x384.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="be7f356" class="elementor-element elementor-element-be7f356 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="dcaf817" class="elementor-element elementor-element-dcaf817 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5f2cc63" class="elementor-element elementor-element-5f2cc63 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Widzimy, że ruch nie jest szyfrowany  i możemy go podsłuchać. Spróbujmy go teraz zabezpieczyć przy pomocy IPSECa.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="09909ea" class="elementor-element elementor-element-09909ea elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="df729e2" class="elementor-element elementor-element-df729e2 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="a197922" class="elementor-element elementor-element-a197922 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #000000;">Konfiguracja IPSEC na każdym routerze wygląda tak samo:</span></p><p><strong><span style="color: #000000;">R1 (HUB), R2 (SPOKE1), R3 (SPOKE2), R4 (SPOKE3)</span></strong></p><pre><span style="color: #000000;">crypto isakmp policy 10</span><br /><span style="color: #000000;"> encr aes</span><br /><span style="color: #000000;"> authentication pre-share</span><br /><span style="color: #000000;"> group 2</span><br /><span style="color: #000000;">crypto isakmp key cisco123 address 0.0.0.0</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">crypto ipsec transform-set TSET esp-aes esp-sha-hmac</span><br /><span style="color: #000000;"> mode transport</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">crypto ipsec profile IPSEC_PROFILE</span><br /><span style="color: #000000;"> set transform-set TSET</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">int tunnel 0</span><br /><span style="color: #000000;"> tunnel protection ipsec profile IPSEC_PROFILE</span></pre><p style="text-align: justify;"><span style="color: #000000;">Po skonfigurowaniu IPSEC sprawdźmy czy zestawił się on poprawnie (isakmp sa i ipsec sa). Wystarczy, że dokonamy sprawdzenia na routerze R1 (HUB), ponieważ routery R2, R3, R4 zestawiają tunele tylko z nim.</span></p><p><span style="color: #000000;"><strong>R1 (HUB)</strong></span></p><pre><span style="color: #000000;">HUB#show crypto isakmp sa</span><br /><span style="color: #000000;">IPv4 Crypto ISAKMP SA</span><br /><span style="color: #000000;">dst src state conn-id status</span><br /><span style="color: #000000;">192.168.10.4 192.168.10.1 QM_IDLE 1005 ACTIVE</span><br /><span style="color: #000000;">192.168.10.1 192.168.10.4 QM_IDLE 1004 ACTIVE</span><br /><span style="color: #000000;">192.168.10.1 192.168.10.3 QM_IDLE 1003 ACTIVE</span><br /><span style="color: #000000;">192.168.10.1 192.168.10.2 QM_IDLE 1001 ACTIVE</span><br /><span style="color: #000000;">192.168.10.2 192.168.10.1 QM_IDLE 1002 ACTIVE</span><br /><span style="color: #000000;">192.168.10.3 192.168.10.1 QM_IDLE 1006 ACTIVE</span></pre><pre><span style="color: #000000;">HUB#show crypto ipsec sa</span><br /><br /><span style="color: #000000;">interface: Tunnel0</span><br /><span style="color: #000000;"> Crypto map tag: Tunnel0-head-0, local addr 192.168.10.1</span><br /><br /><span style="color: #000000;">protected vrf: (none)</span><br /><span style="color: #000000;"> local ident (addr/mask/prot/port): (192.168.10.1/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> remote ident (addr/mask/prot/port): (192.168.10.3/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> current_peer 192.168.10.3 port 500</span><br /><span style="color: #000000;"> PERMIT, flags={origin_is_acl,}</span><br /><span style="color: #000000;"> #pkts encaps: 6, #pkts encrypt: 6, #pkts digest: 6</span><br /><span style="color: #000000;"> #pkts decaps: 7, #pkts decrypt: 7, #pkts verify: 7</span><br /><span style="color: #000000;"> #pkts compressed: 0, #pkts decompressed: 0</span><br /><span style="color: #000000;"> #pkts not compressed: 0, #pkts compr. failed: 0</span><br /><span style="color: #000000;"> #pkts not decompressed: 0, #pkts decompress failed: 0</span><br /><span style="color: #000000;"> #send errors 0, #recv errors 0</span><br /><br /><span style="color: #000000;">local crypto endpt.: 192.168.10.1, remote crypto endpt.: 192.168.10.3</span><br /><span style="color: #000000;"> path mtu 1500, ip mtu 1500, ip mtu idb (none)</span><br /><span style="color: #000000;"> current outbound spi: 0x4D074ABE(1292323518)</span><br /><span style="color: #000000;"> PFS (Y/N): N, DH group: none</span><br /><br /><span style="color: #000000;">inbound esp sas:</span><br /><span style="color: #000000;"> spi: 0xA8B99213(2830733843)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 7, flow_id: 7, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4329808/3210)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x81E2FE13(2179137043)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 9, flow_id: 9, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4282574/3210)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x7BDEB7FE(2078193662)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 17, flow_id: 17, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4298093/3218)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">inbound ah sas:</span><br /><br /><span style="color: #000000;">inbound pcp sas:</span><br /><br /><span style="color: #000000;">outbound esp sas:</span><br /><span style="color: #000000;"> spi: 0x2B6C154D(728503629)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 8, flow_id: 8, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4329808/3210)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x1A5D7249(442331721)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 10, flow_id: 10, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4282574/3210)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x4D074ABE(1292323518)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 18, flow_id: 18, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4298093/3218)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">outbound ah sas:</span><br /><br /><span style="color: #000000;">outbound pcp sas:</span><br /><br /><span style="color: #000000;">protected vrf: (none)</span><br /><span style="color: #000000;"> local ident (addr/mask/prot/port): (192.168.10.1/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> remote ident (addr/mask/prot/port): (192.168.10.2/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> current_peer 192.168.10.2 port 500</span><br /><span style="color: #000000;"> PERMIT, flags={origin_is_acl,}</span><br /><span style="color: #000000;"> #pkts encaps: 6, #pkts encrypt: 6, #pkts digest: 6</span><br /><span style="color: #000000;"> #pkts decaps: 7, #pkts decrypt: 7, #pkts verify: 7</span><br /><span style="color: #000000;"> #pkts compressed: 0, #pkts decompressed: 0</span><br /><span style="color: #000000;"> #pkts not compressed: 0, #pkts compr. failed: 0</span><br /><span style="color: #000000;"> #pkts not decompressed: 0, #pkts decompress failed: 0</span><br /><span style="color: #000000;"> #send errors 0, #recv errors 0</span><br /><br /><span style="color: #000000;">local crypto endpt.: 192.168.10.1, remote crypto endpt.: 192.168.10.2</span><br /><span style="color: #000000;"> path mtu 1500, ip mtu 1500, ip mtu idb (none)</span><br /><span style="color: #000000;"> current outbound spi: 0x72B18574(1924236660)</span><br /><span style="color: #000000;"> PFS (Y/N): N, DH group: none</span><br /><br /><span style="color: #000000;">inbound esp sas:</span><br /><span style="color: #000000;"> spi: 0x532102AC(1394672300)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 1, flow_id: 1, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4349860/3205)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0xA0B95616(2696500758)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 3, flow_id: 3, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4203743/3205)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x3D891B1C(1032395548)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 5, flow_id: 5, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4371005/3208)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">inbound ah sas:</span><br /><br /><span style="color: #000000;">inbound pcp sas:</span><br /><br /><span style="color: #000000;">outbound esp sas:</span><br /><span style="color: #000000;"> spi: 0x8888EE44(2290675268)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 2, flow_id: 2, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4349860/3205)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x85FE093(140501139)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 4, flow_id: 4, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4203743/3205)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x72B18574(1924236660)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 6, flow_id: 6, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4371005/3208)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">outbound ah sas:</span><br /><br /><span style="color: #000000;">outbound pcp sas:</span><br /><br /><span style="color: #000000;">protected vrf: (none)</span><br /><span style="color: #000000;"> local ident (addr/mask/prot/port): (192.168.10.1/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> remote ident (addr/mask/prot/port): (192.168.10.4/255.255.255.255/47/0)</span><br /><span style="color: #000000;"> current_peer 192.168.10.4 port 500</span><br /><span style="color: #000000;"> PERMIT, flags={origin_is_acl,}</span><br /><span style="color: #000000;"> #pkts encaps: 1, #pkts encrypt: 1, #pkts digest: 1</span><br /><span style="color: #000000;"> #pkts decaps: 2, #pkts decrypt: 2, #pkts verify: 2</span><br /><span style="color: #000000;"> #pkts compressed: 0, #pkts decompressed: 0</span><br /><span style="color: #000000;"> #pkts not compressed: 0, #pkts compr. failed: 0</span><br /><span style="color: #000000;"> #pkts not decompressed: 0, #pkts decompress failed: 0</span><br /><span style="color: #000000;"> #send errors 0, #recv errors 0</span><br /><br /><span style="color: #000000;">local crypto endpt.: 192.168.10.1, remote crypto endpt.: 192.168.10.4</span><br /><span style="color: #000000;"> path mtu 1500, ip mtu 1500, ip mtu idb (none)</span><br /><span style="color: #000000;"> current outbound spi: 0xD87AECE3(3631934691)</span><br /><span style="color: #000000;"> PFS (Y/N): N, DH group: none</span><br /><br /><span style="color: #000000;">inbound esp sas:</span><br /><span style="color: #000000;"> spi: 0xFCF21C61(4243725409)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 11, flow_id: 11, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4192015/3216)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x8DACF8C3(2376923331)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 13, flow_id: 13, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4370183/3216)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0xF7D288AB(4157769899)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 15, flow_id: 15, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4608000/3218)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">inbound ah sas:</span><br /><br /><span style="color: #000000;">inbound pcp sas:</span><br /><br /><span style="color: #000000;">outbound esp sas:</span><br /><span style="color: #000000;"> spi: 0xE7B4AE5B(3887378011)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 12, flow_id: 12, sibling_flags 80000000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4192015/3216)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0x3D9E28E5(1033775333)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 14, flow_id: 14, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4370183/3216)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><span style="color: #000000;"> spi: 0xD87AECE3(3631934691)</span><br /><span style="color: #000000;"> transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Transport, }</span><br /><span style="color: #000000;"> conn id: 16, flow_id: 16, sibling_flags 80004000, crypto map: Tunnel0-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4608000/3218)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">outbound ah sas:</span><br /><br /><span style="color: #000000;">outbound pcp sas:</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="18bc1c6" class="elementor-element elementor-element-18bc1c6 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="cb65ff2" class="elementor-element elementor-element-cb65ff2 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="8e75408" class="elementor-element elementor-element-8e75408 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Jak widać z wyników powyższych komend wszystkie tunele zestawiły się poprawnie.</span></p><p> </p></div>
				</div>
				</div>
				<div data-id="325aa58" class="elementor-element elementor-element-325aa58 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">WERYFIKACJA</span></h5><p style="text-align: justify;"><span style="color: #000000;">Sprawdźmy teraz co widać w wiresharku przy pingowaniu routera R3 (SPOKE-2) z routera R2 (SPOKE-1). </span></p><pre><span style="color: #000000;">SPOKE1#ping 172.22.10.3</span><br /><span style="color: #000000;">Type escape sequence to abort.</span><br /><span style="color: #000000;">Sending 5, 100-byte ICMP Echos to 172.22.10.3, timeout is 2 seconds:</span><br /><span style="color: #000000;">!!!!!</span><br /><span style="color: #000000;">Success rate is 100 percent (5/5), round-trip min/avg/max = 28/40/60 ms</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="2da996a" class="elementor-element elementor-element-2da996a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="272c8d5" class="elementor-element elementor-element-272c8d5 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap">
					<div class="elementor-widget-wrap">
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="71ebfc5" class="elementor-element elementor-element-71ebfc5 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="c3add74" class="elementor-element elementor-element-c3add74 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="1995834" class="elementor-element elementor-element-1995834 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_2.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-3" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="573" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_2.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_2.png 725w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2018/01/wireshark_2-300x239.png 300w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="f849e56" class="elementor-element elementor-element-f849e56 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="cc127c4" class="elementor-element elementor-element-cc127c4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="fd3de14" class="elementor-element elementor-element-fd3de14 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5> </h5><h5><span style="color: #000000;">PODSUMOWANIE</span></h5><p style="text-align: justify;"><span style="color: #000000;">Jak widać zgodnie z teorią <a style="color: #000000;" href="https://kubsoo.github.io/rsnet-website/ipsec-vpn-teoria/">IPSEC</a> w wiresharku przy pingowaniu widzimy adresy 192.168.10.X (ponieważ skonfigurowaliśmy IPSEC w trybie transportowym), ponadto nie widzimy jaki ruch jest przesyłany. Widzimy tylko pakiety ESP które składają się z ESP SPI oraz numeru sekwencyjnego. DMVPN w połączeniu z IPSEC jest bardzo dobrą kombinacją do budowania skalowanych sieci VPN między oddziałami firmy, ponieważ przy dodawaniu nowego oddziału (SPOKE) dzięki zastosowaniu DMVPN nie musimy nic konfigurować na naszym HUBie i taki nowy oddział po skonfigurowaniu będzie miał łączność pomiędzy innymi oddziałami a IPSEC pozwoli dodatkowo zabezpieczyć transmisję.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja-2/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>DMVPN faza 1 &#8211; konfiguracja</title>
		<link>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/</link>
		<comments>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/#respond</comments>
		<pubDate>Mon, 18 Dec 2017 18:17:16 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Na szybko]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[dmvpn]]></category>
		<category><![CDATA[faza 1]]></category>
		<category><![CDATA[konfiguracja]]></category>
		<category><![CDATA[nhrp]]></category>
		<category><![CDATA[Poradnik]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=956</guid>
		<description><![CDATA[Dynamic Multipoint VPN (DMVPN) faza 1, czyli tunele hub-and-spoke z dynamicznymi mapowaniami NHRP Topologia Konfiguracja R1 hostname HUB!interface Tunnel0 ip address 172.22.10.1 255.255.255.0 ip nhrp network-id 123 tunnel source FastEthernet0/0 tunnel&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-956">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="1c79627" class="elementor-element elementor-element-1c79627 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="9c650a4" class="elementor-element elementor-element-9c650a4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="7aa1a3f" class="elementor-element elementor-element-7aa1a3f elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;"><strong>Dynamic Multipoint VPN (DMVPN) faza 1</strong>, czyli tunele hub-and-spoke z dynamicznymi mapowaniami NHRP</span></p><h5><span style="color: #000000;">Topologia</span></h5></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="918b75f" class="elementor-element elementor-element-918b75f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="a3ada10" class="elementor-element elementor-element-a3ada10 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="af0170c" class="elementor-element elementor-element-af0170c elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="521" height="410" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1.png 521w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/dmvpn_1-300x236.png 300w" sizes="(max-width: 521px) 100vw, 521px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b91bbb2" class="elementor-element elementor-element-b91bbb2 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="24ea96d" class="elementor-element elementor-element-24ea96d elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="1cde9a9" class="elementor-element elementor-element-1cde9a9 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">Konfiguracja</span></h5><p><span style="color: #000000;">R1</span></p><pre><span style="color: #000000;">hostname HUB</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.1 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel mode gre multipoint</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.1 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre><p><span style="color: #000000;">R2</span></p><pre><span style="color: #000000;">hostname SPOKE1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.2 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.2 255.255.255.0</span><br /><span style="color: #000000;">!<br /></span></pre><p><span style="color: #000000;">R3</span></p><pre><span style="color: #000000;">hostname SPOKE2</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.3 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.3 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre><p><span style="color: #000000;">R4</span></p><pre><span style="color: #000000;">hostname SPOKE3</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel0</span><br /><span style="color: #000000;"> ip address 172.22.10.4 255.255.255.0</span><br /><span style="color: #000000;"> ip nhrp map 172.22.10.1 192.168.10.1</span><br /><span style="color: #000000;"> ip nhrp network-id 123</span><br /><span style="color: #000000;"> ip nhrp nhs 172.22.10.1</span><br /><span style="color: #000000;"> tunnel source FastEthernet0/0</span><br /><span style="color: #000000;"> tunnel destination 192.168.10.1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.10.4 255.255.255.0</span><br /><span style="color: #000000;">!</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="3448fe7" class="elementor-element elementor-element-3448fe7 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="e27c1b9" class="elementor-element elementor-element-e27c1b9 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5327d05" class="elementor-element elementor-element-5327d05 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">Przydatne komendy</span></h5><ul><li><span style="color: #000000;">show dmvpn</span></li><li><span style="color: #000000;">show ip nhrp</span></li></ul><p> </p><p><strong><span style="color: #000000;">HUB (R1)</span></strong></p><pre><span style="color: #000000;">HUB#show dmvpn</span><br /><span style="color: #000000;">Legend: Attrb --&gt; S - Static, D - Dynamic, I - Incomplete</span><br /><span style="color: #000000;"> N - NATed, L - Local, X - No Socket</span><br /><span style="color: #000000;"> # Ent --&gt; Number of NHRP entries with same NBMA peer</span><br /><span style="color: #000000;"> NHS Status: E --&gt; Expecting Replies, R --&gt; Responding, W --&gt; Waiting</span><br /><span style="color: #000000;"> UpDn Time --&gt; Up or Down Time for a Tunnel</span><br /><span style="color: #000000;">==========================================================================</span><br /><br /><span style="color: #000000;">Interface: Tunnel0, IPv4 NHRP Details</span><br /><span style="color: #000000;">Type:Hub, NHRP Peers:3,</span><br /><br /><span style="color: #000000;"># Ent Peer NBMA Addr Peer Tunnel Add State UpDn Tm Attrb</span><br /><span style="color: #000000;"> ----- --------------- --------------- ----- -------- -----</span><br /><span style="color: #000000;"> 1 192.168.10.2 172.22.10.2 UP 01:36:59 D</span><br /><span style="color: #000000;"> 1 192.168.10.3 172.22.10.3 UP 01:36:59 D</span><br /><span style="color: #000000;"> 1 192.168.10.4 172.22.10.4 UP 01:36:59 D</span></pre><pre><span style="color: #000000;">HUB#show ip nhrp</span><br /><span style="color: #000000;">172.22.10.2/32 via 172.22.10.2</span><br /><span style="color: #000000;"> Tunnel0 created 01:37:43, expire 01:42:15</span><br /><span style="color: #000000;"> Type: dynamic, Flags: unique registered used</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.2</span><br /><span style="color: #000000;">172.22.10.3/32 via 172.22.10.3</span><br /><span style="color: #000000;"> Tunnel0 created 01:37:44, expire 01:42:15</span><br /><span style="color: #000000;"> Type: dynamic, Flags: unique registered used</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.3</span><br /><span style="color: #000000;">172.22.10.4/32 via 172.22.10.4</span><br /><span style="color: #000000;"> Tunnel0 created 01:37:44, expire 01:42:15</span><br /><span style="color: #000000;"> Type: dynamic, Flags: unique registered used</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.4</span></pre><p><strong><span style="color: #000000;">SPOKE1 (R2)</span></strong></p><pre><span style="color: #000000;">SPOKE1#show dmvpn</span><br /><span style="color: #000000;">Legend: Attrb --&gt; S - Static, D - Dynamic, I - Incomplete</span><br /><span style="color: #000000;"> N - NATed, L - Local, X - No Socket</span><br /><span style="color: #000000;"> # Ent --&gt; Number of NHRP entries with same NBMA peer</span><br /><span style="color: #000000;"> NHS Status: E --&gt; Expecting Replies, R --&gt; Responding, W --&gt; Waiting</span><br /><span style="color: #000000;"> UpDn Time --&gt; Up or Down Time for a Tunnel</span><br /><span style="color: #000000;">==========================================================================</span><br /><br /><span style="color: #000000;">Interface: Tunnel0, IPv4 NHRP Details</span><br /><span style="color: #000000;">Type:Spoke, NHRP Peers:1,</span><br /><br /><span style="color: #000000;"># Ent Peer NBMA Addr Peer Tunnel Add State UpDn Tm Attrb</span><br /><span style="color: #000000;"> ----- --------------- --------------- ----- -------- -----</span><br /><span style="color: #000000;"> 1 192.168.10.1 172.22.10.1 UP 01:39:36 S</span></pre><pre><span style="color: #000000;">SPOKE1#show ip nhrp</span><br /><span style="color: #000000;">172.22.10.1/32 via 172.22.10.1</span><br /><span style="color: #000000;"> Tunnel0 created 01:40:09, never expire</span><br /><span style="color: #000000;"> Type: static, Flags:</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.1</span></pre><p><strong><span style="color: #000000;">SPOKE2 (R3)</span></strong></p><pre><span style="color: #000000;">SPOKE2#show dmvpn</span><br /><span style="color: #000000;">Legend: Attrb --&gt; S - Static, D - Dynamic, I - Incomplete</span><br /><span style="color: #000000;"> N - NATed, L - Local, X - No Socket</span><br /><span style="color: #000000;"> # Ent --&gt; Number of NHRP entries with same NBMA peer</span><br /><span style="color: #000000;"> NHS Status: E --&gt; Expecting Replies, R --&gt; Responding, W --&gt; Waiting</span><br /><span style="color: #000000;"> UpDn Time --&gt; Up or Down Time for a Tunnel</span><br /><span style="color: #000000;">==========================================================================</span><br /><br /><span style="color: #000000;">Interface: Tunnel0, IPv4 NHRP Details</span><br /><span style="color: #000000;">Type:Spoke, NHRP Peers:1,</span><br /><br /><span style="color: #000000;"># Ent Peer NBMA Addr Peer Tunnel Add State UpDn Tm Attrb</span><br /><span style="color: #000000;"> ----- --------------- --------------- ----- -------- -----</span><br /><span style="color: #000000;"> 1 192.168.10.1 172.22.10.1 UP 01:40:38 S</span></pre><pre><span style="color: #000000;">SPOKE2#show ip nhrp</span><br /><span style="color: #000000;">172.22.10.1/32 via 172.22.10.1</span><br /><span style="color: #000000;"> Tunnel0 created 01:41:17, never expire</span><br /><span style="color: #000000;"> Type: static, Flags:</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.1</span></pre><p><strong><span style="color: #000000;">SPOKE3 (R4)</span></strong></p><pre><span style="color: #000000;">SPOKE3#show dmvpn</span><br /><span style="color: #000000;">Legend: Attrb --&gt; S - Static, D - Dynamic, I - Incomplete</span><br /><span style="color: #000000;"> N - NATed, L - Local, X - No Socket</span><br /><span style="color: #000000;"> # Ent --&gt; Number of NHRP entries with same NBMA peer</span><br /><span style="color: #000000;"> NHS Status: E --&gt; Expecting Replies, R --&gt; Responding, W --&gt; Waiting</span><br /><span style="color: #000000;"> UpDn Time --&gt; Up or Down Time for a Tunnel</span><br /><span style="color: #000000;">==========================================================================</span><br /><br /><span style="color: #000000;">Interface: Tunnel0, IPv4 NHRP Details</span><br /><span style="color: #000000;">Type:Spoke, NHRP Peers:1,</span><br /><br /><span style="color: #000000;"># Ent Peer NBMA Addr Peer Tunnel Add State UpDn Tm Attrb</span><br /><span style="color: #000000;"> ----- --------------- --------------- ----- -------- -----</span><br /><span style="color: #000000;"> 1 192.168.10.1 172.22.10.1 UP 01:41:40 S</span></pre><pre><span style="color: #000000;">SPOKE3#show ip nhrp</span><br /><span style="color: #000000;">172.22.10.1/32 via 172.22.10.1</span><br /><span style="color: #000000;"> Tunnel0 created 01:42:22, never expire</span><br /><span style="color: #000000;"> Type: static, Flags:</span><br /><span style="color: #000000;"> NBMA address: 192.168.10.1</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="f0ff15a" class="elementor-element elementor-element-f0ff15a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="5140eb2" class="elementor-element elementor-element-5140eb2 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="d1bee35" class="elementor-element elementor-element-d1bee35 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;"><strong>WERYFIKACJA</strong></span></h5><p><span style="color: #000000;">traceroute SPOKE1 -&gt; SPOKE2</span></p><pre><span style="color: #000000;">SPOKE1#traceroute 172.22.10.3</span><br /><span style="color: #000000;">Type escape sequence to abort.</span><br /><span style="color: #000000;">Tracing the route to 172.22.10.3</span><br /><span style="color: #000000;">VRF info: (vrf in name/id, vrf out name/id)</span><br /><span style="color: #000000;"> 1 172.22.10.1 20 msec 8 msec 12 msec</span><br /><span style="color: #000000;"> 2 172.22.10.3 32 msec 20 msec 24 msec</span></pre><p><span style="color: #000000;">traceroute SPOKE1 -&gt; SPOKE3 </span></p><pre><span style="color: #000000;">SPOKE1#traceroute 172.22.10.4</span><br /><span style="color: #000000;">Type escape sequence to abort.</span><br /><span style="color: #000000;">Tracing the route to 172.22.10.4</span><br /><span style="color: #000000;">VRF info: (vrf in name/id, vrf out name/id)</span><br /><span style="color: #000000;"> 1 172.22.10.1 16 msec 8 msec 8 msec</span><br /><span style="color: #000000;"> 2 172.22.10.4 20 msec 20 msec 24 msec</span></pre><p><span style="color: #000000;">traceroute SPOKE2 -&gt; SPOKE3</span></p><pre><span style="color: #000000;">SPOKE2#traceroute 172.22.10.4</span><br /><span style="color: #000000;">Type escape sequence to abort.</span><br /><span style="color: #000000;">Tracing the route to 172.22.10.4</span><br /><span style="color: #000000;">VRF info: (vrf in name/id, vrf out name/id)</span><br /><span style="color: #000000;"> 1 172.22.10.1 20 msec 20 msec 12 msec</span><br /><span style="color: #000000;"> 2 172.22.10.4 20 msec 20 msec 32 msec</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b17b5e7" class="elementor-element elementor-element-b17b5e7 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="589037f" class="elementor-element elementor-element-589037f elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="c878c6c" class="elementor-element elementor-element-c878c6c elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Jak widać ruch między oddziałami typu SPOKE (172.22.10.2,172.22.10.3,172.22.10.4) odbywa się przez HUB (172.22.10.1). Wyjaśnienie działania DMVPN oraz więcej informacji na temat pozostałych faz DMVPN w następnych wpisach.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/dmvpn-faza-1-konfiguracja/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>IPSec S2S VPN Palo Alto &#8211; Cisco</title>
		<link>https://kubsoo.github.io/rsnet-website/ipsec-s2s-vpn-palo-alto-cisco/</link>
		<comments>https://kubsoo.github.io/rsnet-website/ipsec-s2s-vpn-palo-alto-cisco/#respond</comments>
		<pubDate>Thu, 14 Dec 2017 20:08:07 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[firewall]]></category>
		<category><![CDATA[ipsec]]></category>
		<category><![CDATA[palo alto]]></category>
		<category><![CDATA[vpn]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=851</guid>
		<description><![CDATA[W poniższym wpisie pokażę konfigurację tunelu IPSEC VPN pomiędzy firewallem Palo Alto a routerem CISCO. Konfigurację wykonam w labie GNS3, w którym wykorzystam następujące obrazy: CISCO CSR1000v3.17 &#8211; obraz routera&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-851">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="31f508f" class="elementor-element elementor-element-31f508f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="2e28f4f" class="elementor-element elementor-element-2e28f4f elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="23af124" class="elementor-element elementor-element-23af124 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">W poniższym wpisie pokażę konfigurację tunelu IPSEC VPN pomiędzy firewallem Palo Alto a routerem CISCO. Konfigurację wykonam w labie <a href="https://kubsoo.github.io/rsnet-website/tag/gns3/" title="">GNS3</a>, w którym wykorzystam następujące obrazy:</span></p><ol><li><span style="color: #000000;">CISCO CSR1000v3.17 &#8211; obraz routera CISCO</span></li><li><span style="color: #000000;">PA-VM7.1.1.0-1 &#8211; obraz firewalla Palo Alto w wersji 7.1.1.0-1</span></li><li><span style="color: #000000;">gns3-webterm &#8211; kontener dockera do zarządzania firewallem</span></li></ol></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="cedeb58" class="elementor-element elementor-element-cedeb58 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="d030fcd" class="elementor-element elementor-element-d030fcd elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="a150116" class="elementor-element elementor-element-a150116 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">LAB</span></h5><p><span style="color: #000000;">Topologia laba GNS3 wygląda nastepująco:</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="9757d5f" class="elementor-element elementor-element-9757d5f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="f704425" class="elementor-element elementor-element-f704425 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="19f6e29" class="elementor-element elementor-element-19f6e29 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/topology_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="545" height="408" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/topology_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/topology_1.png 545w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/topology_1-300x225.png 300w" sizes="(max-width: 545px) 100vw, 545px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="469fb17" class="elementor-element elementor-element-469fb17 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="34ab586" class="elementor-element elementor-element-34ab586 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="c159dec" class="elementor-element elementor-element-c159dec elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">Adresacja</span></h5><p><span style="color: #000000;"><strong>Cisco</strong> </span></p><p><span style="color: #000000;">Gi1 &#8211; 150.1.1.1/30</span></p><p><span style="color: #000000;">Tunnel1 &#8211; 10.0.0.1/24</span></p><p><span style="color: #000000;"><strong>Palo Alto</strong> </span></p><p><span style="color: #000000;">ethernet1/1 &#8211; 150.1.1.2/30</span></p><p><span style="color: #000000;">tunnel.1 &#8211; 10.0.0.2/24</span></p><h5> </h5><h5><span style="color: #000000;">Konfiguracja CISCO</span></h5><p><span style="color: #000000;">INTERFACES</span></p><pre><span style="color: #000000;">Router(config)#interface Gi1</span><br /><span style="color: #000000;">Router(config-if)#ip address 150.1.1.1 255.255.255.252</span><br /><span style="color: #000000;">Router(config)#interface Tunnel1</span><br /><span style="color: #000000;">Router(config-if)#ip address 10.0.0.1 255.255.255.0<br />Router(config-if)#tunnel source 150.1.1.1</span><br /><span style="color: #000000;">Router(config-if)#tunnel destination 150.1.1.2</span></pre><p><span style="color: #000000;">ISAKMP POLICY</span></p><pre><span style="color: #000000;">Router(config)#crypto isakmp policy 10</span><br /><span style="color: #000000;">Router(config-isakmp)#hash sha256</span><br /><span style="color: #000000;">Router(config-isakmp)#authentication pre-share</span><br /><span style="color: #000000;">Router(config-isakmp)#group 14</span><br /><span style="color: #000000;">Router(config-isakmp)#lifetime 86400</span><br /><span style="color: #000000;">Router(config-isakmp)#encryption aes 256</span></pre><p><span style="color: #000000;">KLUCZ SZYFRUJĄCY</span></p><pre><span style="color: #000000;">Router(config)#crypto isakmp key 0 palo_to_cisco! address 150.1.1.2</span></pre><p><span style="color: #000000;">IP TRANSFORM SET</span></p><pre><span style="color: #000000;">Router(config)#crypto ipsec transform-set TSET esp-sha512-hmac esp-aes 256</span></pre><p><span style="color: #000000;">IPSEC PROFILE</span></p><pre><span style="color: #000000;">Router(config)#crypto ipsec profile IPSEC-PROFILE</span><br /><span style="color: #000000;">Router(ipsec-profile)#set transform-set TSET</span><br /><span style="color: #000000;">Router(ipsec-profile)#set pfs group14</span><br /><span style="color: #000000;">Router(ipsec-profile)#set security-association lifetime seconds 3600</span></pre><p><span style="color: #000000;">IPSEC TUNNEL</span></p><pre><span style="color: #000000;">Router(config-if)#tunnel mode ipsec ipv4</span><br /><span style="color: #000000;">Router(config-if)#tunnel protection ipsec profile IPSEC-PROFILE</span></pre><h5> </h5><h5><span style="color: #000000;">Cała konfiguracja CISCO</span></h5><pre><span style="color: #000000;">crypto isakmp policy 10</span><br /><span style="color: #000000;"> hash sha256</span><br /><span style="color: #000000;"> authentication pre-share</span><br /><span style="color: #000000;"> group 14</span><br /><span style="color: #000000;"> lifetime 86400</span><br /><span style="color: #000000;"> encryption aes 256</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">crypto isakmp key 0 palo_to_cisco! address 150.1.1.2</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">crypto ipsec transform-set TSET esp-sha512-hmac esp-aes 256</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">crypto ipsec profile IPSEC-PROFILE</span><br /><span style="color: #000000;"> set transform-set TSET</span><br /><span style="color: #000000;"> set pfs group14</span><br /><span style="color: #000000;"> set security-association lifetime seconds 3600</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Gi1</span><br /><span style="color: #000000;"> ip address 150.1.1.1 255.255.255.252</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Tunnel1</span><br /><span style="color: #000000;"> ip address 10.0.0.1 255.255.255.0 <br /> tunnel source 150.1.1.1</span><br /><span style="color: #000000;"> tunnel destination 150.1.1.2</span><br /><span style="color: #000000;"> tunnel mode ipsec ipv4</span><br /><span style="color: #000000;"> tunnel protection ipsec profile IPSEC-PROFILE​</span><br /><span style="color: #000000;">!</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="6994149" class="elementor-element elementor-element-6994149 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="cf4ce67" class="elementor-element elementor-element-cf4ce67 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="2d60a4a" class="elementor-element elementor-element-2d60a4a elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">Konfiguracja PALO ALTO</span></h5><p><span style="color: #000000;">INTERFACE MANAGEMENT PROFILE</span></p><p><span style="color: #000000;">Network -&gt; Network Profiles -&gt; Interface Mgmt</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="bb026d6" class="elementor-element elementor-element-bb026d6 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="dc6c89a" class="elementor-element elementor-element-dc6c89a elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="e561c9d" class="elementor-element elementor-element-e561c9d elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/mgmt_profile.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="486" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/mgmt_profile.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/mgmt_profile.png 809w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/mgmt_profile-300x202.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/mgmt_profile-768x518.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="16794cc" class="elementor-element elementor-element-16794cc elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="9bfc6dc" class="elementor-element elementor-element-9bfc6dc elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="3918199" class="elementor-element elementor-element-3918199 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">INTERFACES</span></p><p><span style="color: #000000;">Network -&gt; Interfaces -&gt; ethernet1/1</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="7d46ae9" class="elementor-element elementor-element-7d46ae9 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="45a03c4" class="elementor-element elementor-element-45a03c4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="d7dc5f2" class="elementor-element elementor-element-d7dc5f2 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="385" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1.png 874w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1-300x160.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1-768x410.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="ed2292a" class="elementor-element elementor-element-ed2292a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="b8e494e" class="elementor-element elementor-element-b8e494e elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="e4192e8" class="elementor-element elementor-element-e4192e8 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_2.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-3" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="466" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_2.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_2.png 863w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_2-300x194.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_2-768x497.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="8f5c2a2" class="elementor-element elementor-element-8f5c2a2 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="687bbe8" class="elementor-element elementor-element-687bbe8 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="2cc3644" class="elementor-element elementor-element-2cc3644 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_3.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-4" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="522" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_3.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_3.png 862w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_3-300x218.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/int_eth1_3-768x557.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="00af2be" class="elementor-element elementor-element-00af2be elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="b01077f" class="elementor-element elementor-element-b01077f elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="024cc1e" class="elementor-element elementor-element-024cc1e elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #000000;">Network -&gt; Interfaces -&gt; tunnel.1</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="340a9cc" class="elementor-element elementor-element-340a9cc elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="1da691d" class="elementor-element elementor-element-1da691d elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="c94e1c6" class="elementor-element elementor-element-c94e1c6 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-5" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="419" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_1.png 806w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_1-300x175.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_1-768x447.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="dd5918a" class="elementor-element elementor-element-dd5918a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="2b2de55" class="elementor-element elementor-element-2b2de55 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="e9ae76a" class="elementor-element elementor-element-e9ae76a elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_2.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-6" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="478" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_2.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_2.png 811w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_2-300x199.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_2-768x509.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="91c4804" class="elementor-element elementor-element-91c4804 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="95253f8" class="elementor-element elementor-element-95253f8 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5c97a74" class="elementor-element elementor-element-5c97a74 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_3.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-7" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="416" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_3.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_3.png 809w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_3-300x173.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/tunnel_3-768x443.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="950f3ec" class="elementor-element elementor-element-950f3ec elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="7aff087" class="elementor-element elementor-element-7aff087 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="84caea1" class="elementor-element elementor-element-84caea1 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">IKE CRYPTO PROFILE</span></p><p><span style="color: #000000;">Network -&gt; Network Profiles -&gt; IKE Crypto</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="085fd5f" class="elementor-element elementor-element-085fd5f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="92edec1" class="elementor-element elementor-element-92edec1 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="ababb15" class="elementor-element elementor-element-ababb15 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ike_policy.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-8" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="349" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ike_policy.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ike_policy.png 994w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ike_policy-300x145.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ike_policy-768x372.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="6d40d43" class="elementor-element elementor-element-6d40d43 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="595be58" class="elementor-element elementor-element-595be58 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="525ebba" class="elementor-element elementor-element-525ebba elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">IKE GATEWAY</span></p><p><span style="color: #000000;">Network -&gt; Network Profiles -&gt; IKE Gateways</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b483a47" class="elementor-element elementor-element-b483a47 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="9198792" class="elementor-element elementor-element-9198792 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="07e8413" class="elementor-element elementor-element-07e8413 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-9" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="501" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway.png 810w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway-300x209.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway-768x535.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="974078c" class="elementor-element elementor-element-974078c elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="dc2f999" class="elementor-element elementor-element-dc2f999 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="90e3e5d" class="elementor-element elementor-element-90e3e5d elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway_2.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-10" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="537" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway_2.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway_2.png 815w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway_2-300x224.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/isakmp_gateway_2-768x573.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="1e5889a" class="elementor-element elementor-element-1e5889a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="6ddafd6" class="elementor-element elementor-element-6ddafd6 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="a5068cc" class="elementor-element elementor-element-a5068cc elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">IPSEC CRYPTO</span></p><p><span style="color: #000000;">Network -&gt; Network Profiles -&gt; IPSec Crypto</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="ff2f8b5" class="elementor-element elementor-element-ff2f8b5 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="1ab1c29" class="elementor-element elementor-element-1ab1c29 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="55d91b5" class="elementor-element elementor-element-55d91b5 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_crypto.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-11" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="418" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_crypto.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_crypto.png 911w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_crypto-300x174.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_crypto-768x446.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="cde951f" class="elementor-element elementor-element-cde951f elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="91856d8" class="elementor-element elementor-element-91856d8 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="a3f0923" class="elementor-element elementor-element-a3f0923 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">IPSEC TUNNEL</span></p><p><span style="color: #000000;">Network -&gt; IPSec Tunnels</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="9cb7948" class="elementor-element elementor-element-9cb7948 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="8f6fed0" class="elementor-element elementor-element-8f6fed0 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="37cd5b8" class="elementor-element elementor-element-37cd5b8 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_tunnel.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-12" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="344" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_tunnel.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_tunnel.png 862w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_tunnel-300x143.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_tunnel-768x367.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="838d817" class="elementor-element elementor-element-838d817 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="0f004ea" class="elementor-element elementor-element-0f004ea elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5802aa4" class="elementor-element elementor-element-5802aa4 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p> </p><p><span style="color: #000000;">COMMIT</span></p><p><span style="color: #000000;">Teraz wystarczy zrobić <strong>commit</strong>.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="ce46ae9" class="elementor-element elementor-element-ce46ae9 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="e4cbf82" class="elementor-element elementor-element-e4cbf82 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="6756b5a" class="elementor-element elementor-element-6756b5a elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5> </h5><h5> </h5><h5><span style="color: #000000;">WERYFIKACJA</span></h5><p style="text-align: justify;"><span style="color: #000000;">Sprawdźmy czy tunel się zestawił. Spróbujmy na routerze CISCO spingować adres tunelu na Palo Alto:</span></p><pre style="text-align: justify;"><span style="color: #000000;">Router#ping 10.0.0.2<br />Type escape sequence to abort.<br />Sending 5, 100-byte ICMP Echos to 10.0.0.2, timeout is 2 seconds:<br />!!!!!<br />Success rate is 100 percent (5/5), round-trip min/avg/max = 2/8/29 ms<br /></span></pre><p style="text-align: justify;"><span style="color: #000000;">Udało się, teraz sprawdźmy teraz jak wyglądają wyniki następujących komend:</span></p><ol><li><span style="color: #000000;">show crypto isakmp sa   (faza 1 &#8211; IKE SA)</span></li><li><span style="color: #000000;">show crypto ipsec sa -(faza 2 &#8211; IPSEC SA)</span></li></ol><pre><span style="color: #000000;">Router#show crypto isakmp sa</span><br /><span style="color: #000000;">IPv4 Crypto ISAKMP SA</span><br /><span style="color: #000000;">dst src state conn-id status</span><br /><span style="color: #000000;">150.1.1.2 150.1.1.1 <strong>QM_IDLE</strong> 1001 ACTIVE</span></pre><pre><span style="color: #000000;">Router#show crypto ipsec sa</span><br /><span style="color: #000000;">interface: Tunnel1</span><br /><span style="color: #000000;"> Crypto map tag: Tunnel1-head-0, local addr 150.1.1.1</span><br /><br /><span style="color: #000000;">protected vrf: (none)</span><br /><span style="color: #000000;"> local ident (addr/mask/prot/port): (0.0.0.0/0.0.0.0/0/0)</span><br /><span style="color: #000000;"> remote ident (addr/mask/prot/port): (0.0.0.0/0.0.0.0/0/0)</span><br /><span style="color: #000000;"> current_peer 150.1.1.2 port 500</span><br /><span style="color: #000000;"> PERMIT, flags={origin_is_acl,}</span><br /><strong><span style="color: #000000;"> #pkts encaps: 5, #pkts encrypt: 5, #pkts digest: 5</span></strong><br /><strong><span style="color: #000000;"> #pkts decaps: 5, #pkts decrypt: 5, #pkts verify: 5</span></strong><br /><span style="color: #000000;"> #pkts compressed: 0, #pkts decompressed: 0</span><br /><span style="color: #000000;"> #pkts not compressed: 0, #pkts compr. failed: 0</span><br /><span style="color: #000000;"> #pkts not decompressed: 0, #pkts decompress failed: 0</span><br /><span style="color: #000000;"> #send errors 0, #recv errors 0</span><br /><br /><span style="color: #000000;">local crypto endpt.: 150.1.1.1, remote crypto endpt.: 150.1.1.2</span><br /><span style="color: #000000;"> plaintext mtu 1422, path mtu 1500, ip mtu 1500, ip mtu idb GigabitEthernet1</span><br /><span style="color: #000000;"> current outbound spi: 0xA402847E(2751628414)</span><br /><span style="color: #000000;"> PFS (Y/N): Y, DH group: group14</span><br /><br /><span style="color: #000000;">inbound esp sas:</span><br /><span style="color: #000000;"> spi: 0x1AB4F9C2(448068034)</span><br /><span style="color: #000000;"> transform: esp-256-aes esp-sha512-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Tunnel, }</span><br /><span style="color: #000000;"> conn id: 2003, flow_id: CSR:3, sibling_flags FFFFFFFF80004048, crypto map: Tunnel1-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4607999/3143)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">inbound ah sas:</span><br /><br /><span style="color: #000000;">inbound pcp sas:</span><br /><br /><span style="color: #000000;">outbound esp sas:</span><br /><span style="color: #000000;"> spi: 0xA402847E(2751628414)</span><br /><span style="color: #000000;"> transform: esp-256-aes esp-sha512-hmac ,</span><br /><span style="color: #000000;"> in use settings ={Tunnel, }</span><br /><span style="color: #000000;"> conn id: 2004, flow_id: CSR:4, sibling_flags FFFFFFFF80004048, crypto map: Tunnel1-head-0</span><br /><span style="color: #000000;"> sa timing: remaining key lifetime (k/sec): (4607999/3143)</span><br /><span style="color: #000000;"> IV size: 16 bytes</span><br /><span style="color: #000000;"> replay detection support: Y</span><br /><span style="color: #000000;"> Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #000000;">outbound ah sas:</span><br /><br /><span style="color: #000000;">outbound pcp sas:</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="bbf9abb" class="elementor-element elementor-element-bbf9abb elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="397ef8d" class="elementor-element elementor-element-397ef8d elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="6dd76e1" class="elementor-element elementor-element-6dd76e1 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Jak widać od strony CISCO wszystko działa, sprawdźmy teraz jak wygląda tunel IPSEC od strony firewalla Palo Alto. </span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="0cb58f0" class="elementor-element elementor-element-0cb58f0 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="f942b94" class="elementor-element elementor-element-f942b94 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5c0ff03" class="elementor-element elementor-element-5c0ff03 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #000000;">Najpierw spingujmy adres tunelu na CISCO:</span></p><pre><span style="color: #000000;">admin@PA-VM&gt; ping source 10.0.0.2 host 10.0.0.1</span><br /><span style="color: #000000;">PING 10.0.0.1 (10.0.0.1) from 10.0.0.2 : 56(84) bytes of data.</span><br /><span style="color: #000000;">64 bytes from 10.0.0.1: icmp_seq=1 ttl=255 time=1.91 ms</span><br /><span style="color: #000000;">64 bytes from 10.0.0.1: icmp_seq=2 ttl=255 time=1.81 ms</span><br /><span style="color: #000000;">64 bytes from 10.0.0.1: icmp_seq=3 ttl=255 time=2.16 ms</span><br /><span style="color: #000000;">64 bytes from 10.0.0.1: icmp_seq=4 ttl=255 time=2.50 ms</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="a3b72bc" class="elementor-element elementor-element-a3b72bc elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="c7b3cd9" class="elementor-element elementor-element-c7b3cd9 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="825df01" class="elementor-element elementor-element-825df01 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">Teraz sprawdźmy status intefejsu. Robimy to w interfejsie webowym w zakładce Network -&gt; IPSec Tunnels</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="340dc72" class="elementor-element elementor-element-340dc72 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="dd7e0c3" class="elementor-element elementor-element-dd7e0c3 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="48faaf8" class="elementor-element elementor-element-48faaf8 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-13" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="171" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_1.png 1004w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_1-300x71.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_1-768x182.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="45a6cd9" class="elementor-element elementor-element-45a6cd9 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="f4d7a56" class="elementor-element elementor-element-f4d7a56 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="e4e6c01" class="elementor-element elementor-element-e4e6c01 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_2.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-14" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="374" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_2.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_2.png 977w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_2-300x156.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_info_2-768x399.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="2c8067a" class="elementor-element elementor-element-2c8067a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="3ba7df7" class="elementor-element elementor-element-3ba7df7 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="0d27c9e" class="elementor-element elementor-element-0d27c9e elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #000000;">Jeśli w polach Status widnieją zielone kropki to znaczy, że tunel zestawił się poprawnie.</span></p><p> </p><h5><span style="color: #000000;">PODSUMOWANIE</span></h5><p style="text-align: justify;"><span style="color: #000000;">Tunel IPSEC między urządzeniami CISCO i PALO ALTO jest bardzo łatwy w konfiguracji i mam nadzieję, że po przeczytaniu powyższego wpisu nie powinien sprawić nikomu kłopotu.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/ipsec-s2s-vpn-palo-alto-cisco/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>BGP &#8211; konfiguracja CISCO</title>
		<link>https://kubsoo.github.io/rsnet-website/bgp-konfiguracja-cisco/</link>
		<comments>https://kubsoo.github.io/rsnet-website/bgp-konfiguracja-cisco/#comments</comments>
		<pubDate>Wed, 06 Dec 2017 21:02:51 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[bgp]]></category>
		<category><![CDATA[cisco]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=825</guid>
		<description><![CDATA[We wpisie BGP &#8211; podstawy opisałem zasadę działania protokołu BGP. Teraz zobaczmy to na przykładzie prostej topologii i skonfigurujmy BGP na routerach CISCO. TOPOLOGIA KONFIGURACJA Wstępna konfiguracja adresów IP: hostname&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-825">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="0eebfe3" class="elementor-element elementor-element-0eebfe3 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="0a6b198" class="elementor-element elementor-element-0a6b198 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="83e3ff1" class="elementor-element elementor-element-83e3ff1 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #000000;">We wpisie <a href="https://kubsoo.github.io/rsnet-website/bgp-podstawy/" title="">BGP &#8211; podstawy</a> opisałem zasadę działania protokołu BGP. Teraz zobaczmy to na przykładzie prostej topologii i skonfigurujmy BGP na routerach CISCO.</span></p><h5><span style="color: #000000;">TOPOLOGIA</span></h5></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="5d6cb1c" class="elementor-element elementor-element-5d6cb1c elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="d5e704c" class="elementor-element elementor-element-d5e704c elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="dc259cc" class="elementor-element elementor-element-dc259cc elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/bgp_1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="566" height="347" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/bgp_1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/bgp_1.png 566w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/bgp_1-300x184.png 300w" sizes="(max-width: 566px) 100vw, 566px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="d99f2d5" class="elementor-element elementor-element-d99f2d5 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="a3279c4" class="elementor-element elementor-element-a3279c4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="dc5e604" class="elementor-element elementor-element-dc5e604 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #000000;">KONFIGURACJA</span></h5><p><span style="color: #000000;">Wstępna konfiguracja adresów IP:</span></p><pre><span style="color: #000000;">hostname R1</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface Loopback0</span><br /><span style="color: #000000;"> ip address 1.1.1.1 255.255.255.255</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.12.1 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet1/0</span><br /><span style="color: #000000;"> ip address 192.168.13.1 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span></pre><pre><span style="color: #000000;">hostname R2</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.12.2 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet1/0</span><br /><span style="color: #000000;"> ip address 192.168.23.2 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span></pre><pre><span style="color: #000000;">hostname R3</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet0/0</span><br /><span style="color: #000000;"> ip address 192.168.23.3 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span><br /><span style="color: #000000;">interface FastEthernet1/0</span><br /><span style="color: #000000;"> ip address 192.168.13.3 255.255.255.0</span><br /><span style="color: #000000;"> duplex full</span><br /><span style="color: #000000;">!</span></pre><p style="text-align: justify;"><span style="color: #000000;">Teraz przystąpmy do konfiguracji BGP. W tym celu na routerze wydajemy w trybie konfiguracji komendę: router bgp ASN, gdzie ASN to numer AS. </span></p><pre style="text-align: justify;"><span style="color: #000000;"> </span><span style="background-color: initial;"><span style="color: #000000;">R1(config)#router bgp 65200</span></span></pre><div style="text-align: justify;"><span style="color: #000000; background-color: initial;">A następnie w konfiguracji bgp wpisujemy adresy sąsiadów i numery AS w których się znajdują: neighbor IP_sąsiada remote-as ASN_sąsiada.</span></div><pre><span style="color: #000000;">R1(config-router)#neighbor 192.168.12.2 remote-as 65100</span></pre><div style="text-align: justify;"><span style="color: #000000;">Konfiguracja sąsiadów BGP na każdym routerze wygląda następująco:</span></div><div><pre><span style="color: #000000;">R1(config)#router bgp 65200</span><br /><span style="color: #000000;">R1(config-router)#neighbor 192.168.12.2 remote-as 65100</span><br /><span style="color: #000000;">R1(config-router)#neighbor 192.168.13.3 remote-as 65200</span></pre></div><div><pre><span style="color: #000000;">R2(config)#router bgp 65100</span><br /><span style="color: #000000;">R2(config-router)#neighbor 192.168.12.1 remote-as 65200</span><br /><span style="color: #000000;">R2(config-router)#neighbor 192.168.23.3 remote-as 65200</span></pre></div><div><pre><span style="color: #000000;">R3(config)#router bgp 65200</span><br /><span style="color: #000000;">R3(config-router)#neighbor 192.168.13.1 remote-as 65200</span><br /><span style="color: #000000;">R3(config-router)#neighbor 192.168.23.2 remote-as 65100</span></pre></div><div style="text-align: justify;"><span style="color: #000000;">Po wydaniu powyższych komend powinny nam się utworzyć relacje sąsiedztwa BGP pomiędzy routerami. Sprawdźmy to komendą: <em>show ip bgp summary</em></span></div><div><pre><span style="color: #000000;">R1#show ip bgp sum</span><br /><span style="color: #000000;">BGP router identifier 192.168.13.1, local AS number 65200</span><br /><span style="color: #000000;">BGP table version is 1, main routing table version 1</span></pre><p> </p><p><span style="color: #000000;">Neighbor V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd</span><br /><span style="color: #000000;">192.168.12.2 4 65100 2 2 1 0 0 00:00:26 0</span><br /><span style="color: #000000;">192.168.13.3 4 65200 3 3 1 0 0 00:00:59 0</span></p><pre><span style="color: #000000;">R2#show ip bgp summary</span><br /><span style="color: #000000;">BGP router identifier 192.168.23.2, local AS number 65100</span><br /><span style="color: #000000;">BGP table version is 1, main routing table version 1</span></pre><p> </p><p><span style="color: #000000;">Neighbor V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd</span><br /><span style="color: #000000;">192.168.12.1 4 65200 2 2 1 0 0 00:00:30 0</span><br /><span style="color: #000000;">192.168.23.3 4 65200 2 2 1 0 0 00:00:10 0</span></p><pre><span style="color: #000000;">R3#show ip bgp summary</span><br /><span style="color: #000000;">BGP router identifier 192.168.23.3, local AS number 65200</span><br /><span style="color: #000000;">BGP table version is 1, main routing table version 1</span></pre><p> </p><p><span style="color: #000000;">Neighbor V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd</span><br /><span style="color: #000000;">192.168.13.1 4 65200 4 4 1 0 0 00:01:57 0</span><br /><span style="color: #000000;">192.168.23.2 4 65100 4 4 1 0 0 00:01:03 0</span></p></div><div style="text-align: justify;"><span style="color: #000000;">Jak widać relacje sąsiedzta się nawiązały, jednak żadnymi trasami się nie wymieniły (State/PrxRcd). Rozgłośmy więc na R1 trasę do interfejsu loopback:</span></div><div><pre><span style="color: #000000;">R1(config)#int loopback 0</span><br /><span style="color: #000000;">R1(config-if)#ip address 1.1.1.1 255.255.255.255</span></pre></div><pre><span style="color: #000000;">R1(config)#router bgp 65200</span><br /><span style="color: #000000;">R1(config-router)#network 1.1.1.1 mask 255.255.255.255</span></pre><div style="text-align: justify;"><span style="color: #000000;">Po kilkunastu sekundach powinniśmy na routerach R2 i R3 zobaczyć trasy do sieci 1.1.1.1. Możemy to sprawdzić komendą: <em>show ip bgp</em></span></div><div><pre><span style="color: #000000;">R1#show ip bgp</span><br /><span style="color: #000000;">BGP table version is 2, local router ID is 192.168.13.1</span><br /><span style="color: #000000;">Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,</span><br /><span style="color: #000000;">  r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,</span><br /><span style="color: #000000;">  x best-external, a additional-path, c RIB-compressed,</span><br /><span style="color: #000000;">Origin codes: i - IGP, e - EGP, ? - incomplete</span><br /><span style="color: #000000;">RPKI validation codes: V valid, I invalid, N Not found</span><br /><span style="color: #000000;"><br />    Network    Next Hop  Metric LocPrf Weight Path</span><br /><span style="color: #000000;"> *&gt; 1.1.1.1/32 0.0.0.0 0               32768  i</span></pre></div><div><pre><span style="color: #000000;">R2#show ip bgp</span><br /><span style="color: #000000;">BGP table version is 2, local router ID is 192.168.23.2</span><br /><span style="color: #000000;">Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,</span><br /><span style="color: #000000;">  r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,</span><br /><span style="color: #000000;">  x best-external, a additional-path, c RIB-compressed,</span><br /><span style="color: #000000;">Origin codes: i - IGP, e - EGP, ? - incomplete</span><br /><span style="color: #000000;">RPKI validation codes: V valid, I invalid, N Not found</span></pre><p> </p><p><span style="color: #000000;">  Network Next Hop Metric LocPrf Weight Path</span><br /><span style="color: #000000;"> * 1.1.1.1/32 192.168.23.3 0 65200 i</span><br /><span style="color: #000000;"> *&gt; 192.168.12.1 0 0 65200 i</span></p></div><div><pre><span style="color: #000000;">R3#show ip bgp</span><br /><span style="color: #000000;">BGP table version is 2, local router ID is 192.168.23.3</span><br /><span style="color: #000000;">Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,</span><br /><span style="color: #000000;">  r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,</span><br /><span style="color: #000000;">  x best-external, a additional-path, c RIB-compressed,</span><br /><span style="color: #000000;">Origin codes: i - IGP, e - EGP, ? - incomplete</span><br /><span style="color: #000000;">RPKI validation codes: V valid, I invalid, N Not found</span></pre><p> </p><p><span style="color: #000000;"> Network Next Hop Metric LocPrf Weight Path</span><br /><span style="color: #000000;"> *&gt;i 1.1.1.1/32 192.168.13.1 0 100 0 i</span></p></div><div style="text-align: justify;"><span style="color: #000000;">Jak widać na wynikach powyższych komend, trasa do sieci 1.1.1.1 została poprawnie rozgłoszona. Możemy również odczytać atrybuty z jakie posiada ta trasa na każdym routerze. </span></div><div> </div><div style="text-align: justify;"><span style="color: #000000;">Na R1 trasa do sieci 1.1.1.1/32 ma następujące atrybuty:</span></div><pre><span style="color: #000000;">    Network    Next Hop   Metric LocPrf Weight Path</span><br /><span style="color: #000000;"> *&gt; 1.1.1.1/32 0.0.0.0         0         32768 i</span></pre><div style="text-align: justify;"><span style="color: #000000;">Next Hop = 0.0.0.0 &#8211; ponieważ trasa jest bezpośrednio połączona z routerem R1 (interfejs Loopback0)</span></div><div><span style="color: #000000;">AS Path = i  &#8211; czyli trasa jest w tym samym AS co router (internal)</span></div><div><span style="color: #000000;">Metric (MED) &#8211; 0 &#8211; domyślna metryka</span></div><div><span style="color: #000000;">Weight = 32768 (bo jest to trasa lokalna)</span></div><div> </div><div><span style="color: #000000;">Atrybuty dla tej samej sieci na R2 wyglądają następująco:</span></div><pre><span style="color: #000000;">    Network     Next Hop      Metric LocPrf Weight  Path</span><br /><span style="color: #000000;"> *  1.1.1.1/32  192.168.23.3                     0  65200 i</span><br /><span style="color: #000000;"> *&gt;             192.168.12.1       0             0  65200 i</span></pre><div style="text-align: justify;"><span style="color: #000000;">Jak widać są dwie trasy do sieci 1.1.1.1, jedna z nich jest trasą preferowaną wybraną na podstawie porównywania atrybutów w odpowiedniej kolejności. Sprawdźmy więc która trasa będzie trasą preferowaną. Dla przypomnienia kolejności porównywania atrybutów znajduje się pod tym <a href="https://kubsoo.github.io/rsnet-website/bgp-podstawy/">linkiem</a>.</span></div><div> </div><div style="text-align: justify;"><span style="color: #000000;">Wyświetlić więcej atrybutów możemy poleceniem show ip bgp ip_sieci:</span></div><pre><span style="color: #000000;">R2#show ip bgp 1.1.1.1</span><br /><span style="color: #000000;">BGP routing table entry for 1.1.1.1/32, version 2</span><br /><span style="color: #000000;">Paths: (2 available, best #2, table default)</span><br /><span style="color: #000000;"> Advertised to update-groups:</span><br /><span style="color: #000000;"> 1</span><br /><span style="color: #000000;"> Refresh Epoch 1</span><br /><span style="color: #000000;"> 65200</span><br /><span style="color: #000000;"> 192.168.23.3 from 192.168.23.3 (192.168.23.3)</span><br /><span style="color: #000000;"> Origin IGP, localpref 100, valid, external</span><br /><span style="color: #000000;"> rx pathid: 0, tx pathid: 0</span><br /><span style="color: #000000;"> Refresh Epoch 1</span><br /><span style="color: #000000;"> 65200</span><br /><span style="color: #000000;"> 192.168.12.1 from 192.168.12.1 (192.168.13.1)</span><br /><span style="color: #000000;"> Origin IGP, metric 0, localpref 100, valid, external, best</span><br /><span style="color: #000000;"> rx pathid: 0, tx pathid: 0x0</span></pre><div><span style="color: #000000;">Sprawdźmy teraz po kolei wybór najlepszej trasy:</span></div><div> </div><div><span style="color: #000000;">1. Weight &#8211; dla obu tras jest taka sama wartość 0.</span></div><div><span style="color: #000000;">2. Local Preference &#8211; nie ma wartości</span></div><div><span style="color: #000000;">3. Self-originated &#8211; wiemy, że trasy są rozgłaszane przez sąsiadów więc nie są self-originated</span></div><div><span style="color: #000000;">4. AS Path &#8211; obie trasy mają taki sam atrybut. 65200 i</span></div><div><span style="color: #000000;">5. Origin &#8211; IGP </span></div><div><span style="color: #000000;">6. Metric (MED) &#8211; dla obu tras jest taka sama wartość 0</span></div><div><span style="color: #000000;">7. External &#8211; obie trasy są eBGP</span></div><div><span style="color: #000000;"><span style="color: #000000;">8. IGP Cost &#8211; jest taki sam bo są to trasy statyczne</span></span></div><div style="text-align: justify;"><span style="color: #000000;">9. EBGP Peering &#8211; preferowana jest starsza ścieżka, w naszym przypadku starszą ścieżką jest ścieżka przez R1, ponieważ ta relacja sąsiedztwa została nawiązana wcześniej.</span></div><div> </div><div><span style="color: #000000;">Pokrywa się to z wynikiem komendy show ip bgp na R2:</span></div><pre><span style="color: #000000;">    Network     Next Hop      Metric LocPrf Weight  Path</span><br /><span style="color: #000000;"> *  1.1.1.1/32  192.168.23.3                     0  65200 i</span><br /><span style="color: #000000;"> *&gt;             192.168.12.1       0             0  65200 i</span></pre><div style="text-align: justify;"><span style="color: #000000;">Najlepsza trasa jest zaznaczona znakiem &gt; i jak widać kieruje na next-hop R1.</span></div><div> </div><div> </div><h5><span style="color: #000000;">PODSUMOWANIE</span></h5><p style="text-align: justify;"><span style="color: #000000;">Podstawowa konfiguracja BGP na routerach CISCO jest dosyć prosta, w następnych wpisać postaram się pokazać bardziej zaawansowanej konfiguracji BGP, oraz metody sterowania ruchem w BGP.1</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/bgp-konfiguracja-cisco/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>CISCO IPSEC VPN &#8211; konfiguracja</title>
		<link>https://kubsoo.github.io/rsnet-website/cisco-ipsec-vpn-konfiguracja/</link>
		<pubDate>Sat, 02 Dec 2017 13:20:57 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[ikev1]]></category>
		<category><![CDATA[ipsec]]></category>
		<category><![CDATA[vpn]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=422</guid>
		<description><![CDATA[Jak skonfigurować tunel IPSEC VPN pomiędzy dwoma routerami CISCO? Tunel IPSEC VPN pomiędzy dwoma routerami CISCO konfigurujemy w następujących krokach: Globalne uruchomienie usługi Konfiguracja ISAKMP Policy Konfiguracja kluczy szyfrujących Konfiguracja&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-422">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="b1b02fb" class="elementor-element elementor-element-b1b02fb elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="28e54cb" class="elementor-element elementor-element-28e54cb elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="efb69eb" class="elementor-element elementor-element-efb69eb elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #333333;">Jak skonfigurować tunel IPSEC VPN pomiędzy dwoma routerami CISCO?</span></p><p style="text-align: justify;"><span style="color: #333333;">Tunel IPSEC VPN pomiędzy dwoma routerami CISCO konfigurujemy w następujących krokach:</span></p><ol><li style="text-align: justify;"><span style="color: #333333;">Globalne uruchomienie usługi</span></li><li style="text-align: justify;"><span style="color: #333333;">Konfiguracja ISAKMP Policy</span></li><li style="text-align: justify;"><span style="color: #333333;">Konfiguracja kluczy szyfrujących</span></li><li style="text-align: justify;"><span style="color: #333333;">Konfiguracja IP transform set</span></li><li style="text-align: justify;"><span style="color: #333333;">Stworzenie ACL wskazującej na ruch, który chcemy szyfrować</span></li><li style="text-align: justify;"><span style="color: #333333;">Stworzenie crypto-mapy i wskazanie IP transform set</span></li><li style="text-align: justify;"><span style="color: #333333;">Podpięcie crypto-mapy do interfejsu podpiętego do internetu.</span></li></ol></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="d1e3db9" class="elementor-element elementor-element-d1e3db9 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="daf9c3c" class="elementor-element elementor-element-daf9c3c elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="51b6f86" class="elementor-element elementor-element-51b6f86 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5>PRZYKŁAD</h5><div style="text-align: justify;"><span style="color: #333333;">Tunel IPSEC VPN zestawimy pomiędzy routerami R1 i R3 z poniższej topologii:</span></div></div>
				</div>
				</div>
				<div data-id="f8aeda3" class="elementor-element elementor-element-f8aeda3 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec1.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title="">
							<img width="478" height="218" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec1.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec1.png 478w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec1-300x137.png 300w" sizes="(max-width: 478px) 100vw, 478px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="3fa8a58" class="elementor-element elementor-element-3fa8a58 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="462f9d3" class="elementor-element elementor-element-462f9d3 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="50a5876" class="elementor-element elementor-element-50a5876 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #333333;">Konfiguracja podstawowa: </span></h5><pre><span style="color: #333333;">hostname R1</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface Loopback0</span><br /><span style="color: #333333;">ip address 1.1.1.1 255.255.255.255</span><br /><span style="color: #333333;">ip nat inside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface FastEthernet0/0</span><br /><span style="color: #333333;">ip address 192.168.12.1 255.255.255.0</span><br /><span style="color: #333333;">ip nat outside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip nat inside source list 100 interface FastEthernet0/0 overload</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip route 0.0.0.0 0.0.0.0 192.168.12.2</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">access-list 100 deny ip host 1.1.1.1 host 3.3.3.3</span><br /><span style="color: #333333;">access-list 100 permit ip host 1.1.1.1 any</span></pre><div><pre><span style="color: #333333;">hostname R3</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface Loopback0</span><br /><span style="color: #333333;">ip address 3.3.3.3 255.255.255.255</span><br /><span style="color: #333333;">ip nat inside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface FastEthernet0/0</span><br /><span style="color: #333333;">ip address 192.168.23.3 255.255.255.0</span><br /><span style="color: #333333;">ip nat outside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip nat inside source list 100 interface FastEthernet0/0 overload</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip route 0.0.0.0 0.0.0.0 192.168.23.2</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">access-list 100 deny ip host 3.3.3.3 host 1.1.1.1</span><br /><span style="color: #333333;">access-list 100 permit ip host 3.3.3.3 any</span></pre></div></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="07fb301" class="elementor-element elementor-element-07fb301 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="c7196f9" class="elementor-element elementor-element-c7196f9 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5b0766e" class="elementor-element elementor-element-5b0766e elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h4><strong>KONFIGURACJA IPSEC VPN</strong></h4><p> </p><h5><span style="color: #333333;">1. Globalne uruchomienie usługi</span></h5><pre><span style="color: #333333;">R1(config)#crypto isakmp enable</span><br /><br /><span style="color: #333333;">R3(config)#crypto isakmp enable</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="8fffee0" class="elementor-element elementor-element-8fffee0 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="0f71aa4" class="elementor-element elementor-element-0f71aa4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="fdc4270" class="elementor-element elementor-element-fdc4270 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #333333;">2. Konfiguracja ISAKMP Policy</span></h5><pre><span style="color: #333333;">R1(config)#crypto isakmp </span><br /><span style="color: #333333;">R1(config)#policy 10</span><br /><span style="color: #333333;">R1(config)#encr 3des</span><br /><span style="color: #333333;">R1(config)#hash md5</span><br /><span style="color: #333333;">R1(config)#authentication </span><br /><span style="color: #333333;">R1(config)#pre-share</span><br /><span style="color: #333333;">R1(config)#group 15</span><br /><br /><span style="color: #333333;">R3(config)#crypto isakmp </span><br /><span style="color: #333333;">R3(config)#policy 10</span><br /><span style="color: #333333;">R3(config)#encr 3des</span><br /><span style="color: #333333;">R3(config)#hash md5</span><br /><span style="color: #333333;">R3(config)#authentication </span><br /><span style="color: #333333;">R3(config)#pre-share</span><br /><span style="color: #333333;">R3(config)#group 15</span></pre><p style="text-align: justify;"><span style="color: #333333;">Na obu routerach ISAKMP policy musi być taka sama  w celu zestwienia fazy 1 ISAKMP.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b785cc4" class="elementor-element elementor-element-b785cc4 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="eb21dfc" class="elementor-element elementor-element-eb21dfc elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="7527744" class="elementor-element elementor-element-7527744 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #333333;">3. Konfiguracja kluczy szyfrujących</span></h5><pre><span style="color: #333333;">R1(config)#crypto isakmp key cisco123 address 192.168.23.3</span><br /><br /><span style="color: #333333;">R3(config)#crypto isakmp key cisco123 address 192.168.12.1</span></pre><p style="text-align: justify;"><span style="color: #333333;">W kluczach szyfrujących podajemy adres IP peer&#8217;a, z którym chcemy nawiązać tunel IPSEC VPN.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="47889a1" class="elementor-element elementor-element-47889a1 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="68ff672" class="elementor-element elementor-element-68ff672 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="3e76343" class="elementor-element elementor-element-3e76343 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #333333;">4. Konfiguracja IP transform set</span></h5><pre><span style="color: #333333;">R1(config)#crypto ipsec transform-set TSET esp-aes esp-sha-hmac</span><br /><span style="color: #333333;">R1(cfg-crypto-trans)#mode tunnel</span><br /><br /><span style="color: #333333;">R3(config)#crypto ipsec transform-set TSET esp-aes esp-sha-hmac</span><br /><span style="color: #333333;">R3(cfg-crypto-trans)#mode tunnel</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="b32108d" class="elementor-element elementor-element-b32108d elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="0f6cd58" class="elementor-element elementor-element-0f6cd58 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="23df267" class="elementor-element elementor-element-23df267 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5><span style="color: #333333;">5. Stworzenie ACL wskazującej na ruch, który chcemy szyfrować</span></h5><pre><span style="color: #333333;">R1(config)#access-list 101 permit ip host 3.3.3.3 host 1.1.1.1</span><br /><br /><span style="color: #333333;">R3(config)#access-list 101 permit ip host 3.3.3.3 host 1.1.1.1</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="cf1966a" class="elementor-element elementor-element-cf1966a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="81b3f44" class="elementor-element elementor-element-81b3f44 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="ddb2665" class="elementor-element elementor-element-ddb2665 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5 style="text-align: justify;"><span style="color: #333333;">6. Stworzenie crypto-mapy i wskazanie IP transform set</span></h5><pre><span style="color: #333333;">R1(config)#crypto map CMAP 10 ipsec-isakmp</span><br /><span style="color: #333333;">% NOTE: This new crypto map will remain disabled until a peer</span><br /><span style="color: #333333;"> and a valid access list have been configured.</span><br /><span style="color: #333333;">R1(config-crypto-map)#set peer 192.168.23.3</span><br /><span style="color: #333333;">R1(config-crypto-map)#set transform-set TSET</span><br /><span style="color: #333333;">R1(config-crypto-map)#match address 101</span><br /><br /><span style="color: #333333;">R3(config)#crypto map CMAP 10 ipsec-isakmp</span><br /><span style="color: #333333;">% NOTE: This new crypto map will remain disabled until a peer</span><br /><span style="color: #333333;"> and a valid access list have been configured.</span><br /><span style="color: #333333;">R3(config-crypto-map)#set peer 192.168.12.1</span><br /><span style="color: #333333;">R3(config-crypto-map)#set transform-set TSET</span><br /><span style="color: #333333;">R3(config-crypto-map)#match address 101</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="0fdc430" class="elementor-element elementor-element-0fdc430 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="c98401c" class="elementor-element elementor-element-c98401c elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="6dc4059" class="elementor-element elementor-element-6dc4059 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h5 style="text-align: justify;"><span style="color: #333333;">7. Podpięcie crypto-mapy do interfejsu podpiętego do internetu.</span></h5><pre><span style="color: #333333;">R1(config)#int fastEthernet 0/0</span><br /><span style="color: #333333;">R1(config-if)#crypto map CMAP</span><br /><br /><span style="color: #333333;">R3(config)#int fastEthernet 0/0</span><br /><span style="color: #333333;">R3(config-if)#crypto map CMAP</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="abe1600" class="elementor-element elementor-element-abe1600 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="4ce8b5e" class="elementor-element elementor-element-4ce8b5e elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="3932a93" class="elementor-element elementor-element-3932a93 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><h4><span style="color: #333333;"><strong>PODSUMOWANIE</strong></span></h4><p><span style="color: #333333;">Cała konfiguracja wygląda następująco:</span></p><p><span style="color: #333333;"><strong>R1</strong></span></p><pre><span style="color: #333333;">R1#show run</span><br />!<br /><span style="color: #333333;">hostname R1</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">crypto isakmp policy 10</span><br /><span style="color: #333333;"> encr 3des</span><br /><span style="color: #333333;"> hash md5</span><br /><span style="color: #333333;"> authentication pre-share</span><br /><span style="color: #333333;"> group 15</span><br /><span style="color: #333333;">crypto isakmp key cisco123 address 192.168.23.3</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">crypto ipsec transform-set TSET esp-aes esp-sha-hmac</span><br /><span style="color: #333333;"> mode tunnel</span><br />!<br /><span style="color: #333333;">crypto map CMAP 10 ipsec-isakmp</span><br /><span style="color: #333333;"> set peer 192.168.23.3</span><br /><span style="color: #333333;"> set transform-set TSET</span><br /><span style="color: #333333;"> match address 101</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface Loopback0</span><br /><span style="color: #333333;"> ip address 1.1.1.1 255.255.255.255</span><br /><span style="color: #333333;"> ip nat inside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface FastEthernet0/0</span><br /><span style="color: #333333;"> ip address 192.168.12.1 255.255.255.0</span><br /><span style="color: #333333;"> ip nat outside</span><br /><span style="color: #333333;"> duplex full</span><br /><span style="color: #333333;"> crypto map CMAP</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip nat inside source list 100 interface FastEthernet0/0 overload</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip route 0.0.0.0 0.0.0.0 192.168.12.2</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">access-list 100 deny ip host 1.1.1.1 host 3.3.3.3</span><br /><span style="color: #333333;">access-list 100 permit ip host 1.1.1.1 any</span><br /><span style="color: #333333;">access-list 101 permit ip host 1.1.1.1 host 3.3.3.3</span><br /><span style="color: #333333;">!</span></pre><p><span style="color: #333333;"><strong>R3</strong></span></p><pre><span style="color: #333333;">R3#show run</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">hostname R3</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">crypto isakmp policy 10</span><br /><span style="color: #333333;"> encr 3des</span><br /><span style="color: #333333;"> hash md5</span><br /><span style="color: #333333;"> authentication pre-share</span><br /><span style="color: #333333;"> group 15</span><br /><span style="color: #333333;">crypto isakmp key cisco123 address 192.168.12.1</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">crypto ipsec transform-set TSET esp-aes esp-sha-hmac</span><br /><span style="color: #333333;"> mode tunnel</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">crypto map CMAP 10 ipsec-isakmp</span><br /><span style="color: #333333;"> set peer 192.168.12.1</span><br /><span style="color: #333333;"> set transform-set TSET</span><br /><span style="color: #333333;"> match address 101</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface Loopback0</span><br /><span style="color: #333333;"> ip address 3.3.3.3 255.255.255.255</span><br /><span style="color: #333333;"> ip nat inside</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">interface FastEthernet0/0</span><br /><span style="color: #333333;"> ip address 192.168.23.3 255.255.255.0</span><br /><span style="color: #333333;"> ip nat outside</span><br /><span style="color: #333333;"> duplex full</span><br /><span style="color: #333333;"> crypto map CMAP</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">ip nat inside source list 100 interface FastEthernet0/0 overload</span><br />!<br /><span style="color: #333333;">ip route 0.0.0.0 0.0.0.0 192.168.23.2</span><br /><span style="color: #333333;">!</span><br /><span style="color: #333333;">access-list 100 deny ip host 3.3.3.3 host 1.1.1.1</span><br /><span style="color: #333333;">access-list 100 permit ip host 3.3.3.3 any</span><br /><span style="color: #333333;">access-list 101 permit ip host 3.3.3.3 host 1.1.1.1</span><br /><span style="color: #333333;">!</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="1069507" class="elementor-element elementor-element-1069507 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="5e2c9b5" class="elementor-element elementor-element-5e2c9b5 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="eeedc85" class="elementor-element elementor-element-eeedc85 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #333333;">Tunel IPSEC VPN zestawi się tylko wtedy kiedy router zobaczy na ruch który pasuje do ACL 101 w crypto-mapie. Spróbujmy więc wydać komendę ping ip 3.3.3.3 source 1.1.1.1 na routerze R1:</span></p><pre><span style="color: #333333;">R1#ping ip 3.3.3.3 source 1.1.1.1</span><br /><span style="color: #333333;">Type escape sequence to abort.</span><br /><span style="color: #333333;">Sending 5, 100-byte ICMP Echos to 3.3.3.3, timeout is 2 seconds:</span><br /><span style="color: #333333;">Packet sent with a source address of 1.1.1.1</span><br /><span style="color: #333333;">.!!!!</span><br /><span style="color: #333333;">Success rate is 80 percent (4/5), round-trip min/avg/max = 28/32/44 ms</span></pre><p style="text-align: justify;"><span style="color: #333333;">Łączność jest, czyli tunel się zestawił. Sprawdźmy to wydając nastepujące komendy:</span></p><ul><li><span style="color: #333333;">show crypto isakmp sa</span></li><li><span style="color: #333333;">show crypto ipsec sa</span></li></ul><pre><span style="color: #333333;">R1#show crypto isakmp sa</span><br /><span style="color: #333333;">IPv4 Crypto ISAKMP SA</span><br /><span style="color: #333333;">dst src state conn-id status</span><br /><strong><span style="color: #333333;">192.168.23.3 192.168.12.1 QM_IDLE 1001 ACTIVE</span></strong></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="375682a" class="elementor-element elementor-element-375682a elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="dbcea67" class="elementor-element elementor-element-dbcea67 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="5b02e97" class="elementor-element elementor-element-5b02e97 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><pre><span style="color: #333333;">R1#show crypto ipsec sa</span><br /><span style="color: #333333;">interface: FastEthernet0/0</span><br /><span style="color: #333333;">    Crypto map tag: CMAP, local addr 192.168.12.1</span><br /><span style="color: #333333;">   <br />protected vrf: (none)</span><br /><span style="color: #333333;">   local  ident (addr/mask/prot/port): (1.1.1.1/255.255.255.255/0/0)</span><br /><span style="color: #333333;">   remote ident (addr/mask/prot/port): (3.3.3.3/255.255.255.255/0/0)</span><br /><span style="color: #333333;">   current_peer 192.168.23.3 port 500</span><br /><span style="color: #333333;">     PERMIT, flags={origin_is_acl,}</span><br /><span style="color: #333333;">    <strong>#pkts encaps: 3, #pkts encrypt: 3, #pkts digest: 3</strong></span><br /><strong><span style="color: #333333;">    #pkts decaps: 3, #pkts decrypt: 3, #pkts verify: 3</span></strong><br /><span style="color: #333333;">    #pkts compressed: 0, #pkts decompressed: 0</span><br /><span style="color: #333333;">    #pkts not compressed: 0, #pkts compr. failed: 0</span><br /><span style="color: #333333;">    #pkts not decompressed: 0, #pkts decompress failed: 0</span><br /><span style="color: #333333;">    #send errors 0, #recv errors 0</span><br /><span style="color: #333333;"><br />     local crypto endpt.: 192.168.12.1, remote crypto endpt.: 192.168.23.3</span><br /><span style="color: #333333;">     path mtu 1500, ip mtu 1500, ip mtu idb FastEthernet0/0</span><br /><span style="color: #333333;">     current outbound spi: 0x34978E4A(882347594)</span><br /><span style="color: #333333;">     PFS (Y/N): N, DH group: none</span><br /><br /><span style="color: #333333;">     inbound esp sas:</span><br /><span style="color: #333333;">      spi: 0x6DB519C5(1840585157)</span><br /><span style="color: #333333;">        transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #333333;">        in use settings ={Tunnel, }</span><br /><span style="color: #333333;">        conn id: 1, flow_id: 1, sibling_flags 80004040, crypto map: CMAP</span><br /><span style="color: #333333;">        sa timing: remaining key lifetime (k/sec): (4253546/3593)</span><br /><span style="color: #333333;">        IV size: 16 bytes</span><br /><span style="color: #333333;">        replay detection support: Y</span><br /><span style="color: #333333;">        Status: ACTIVE(ACTIVE)</span><br /><br /><span style="color: #333333;">     inbound ah sas:</span><br /><br /><span style="color: #333333;">     inbound pcp sas:</span><br /><span style="color: #333333;"><br />     outbound esp sas:</span><br /><span style="color: #333333;">      spi: 0x34978E4A(882347594)</span><br /><span style="color: #333333;">        transform: esp-aes esp-sha-hmac ,</span><br /><span style="color: #333333;">        in use settings ={Tunnel, }</span><br /><span style="color: #333333;">        conn id: 2, flow_id: 2, sibling_flags 80004040, crypto map: CMAP</span><br /><span style="color: #333333;">        sa timing: remaining key lifetime (k/sec): (4253546/3593)</span><br /><span style="color: #333333;">        IV size: 16 bytes</span><br /><span style="color: #333333;">        replay detection support: Y</span><br /><span style="color: #333333;">        Status: ACTIVE(ACTIVE)</span><br /><span style="color: #333333;"><br />     outbound ah sas:</span><br /><span style="color: #333333;"><br />     outbound pcp sas:</span></pre></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="191664c" class="elementor-element elementor-element-191664c elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="61cd9e4" class="elementor-element elementor-element-61cd9e4 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="eb77ae5" class="elementor-element elementor-element-eb77ae5 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><span style="color: #333333;">Zobaczmy teraz co widać na interfejsie FastEthernet 0/0 routera R3 w trakcie pingu:</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="6198c71" class="elementor-element elementor-element-6198c71 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="b654f80" class="elementor-element elementor-element-b654f80 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="c9d0423" class="elementor-element elementor-element-c9d0423 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="252" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec.png 725w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/11/ipsec-300x105.png 300w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="50499e5" class="elementor-element elementor-element-50499e5 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="da64596" class="elementor-element elementor-element-da64596 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="d57bcc9" class="elementor-element elementor-element-d57bcc9 elementor-widget elementor-widget-image" data-element_type="image.default">
				<div class="elementor-widget-container">
					<div class="elementor-image">
											<a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_3.png" data-elementor-open-lightbox="no" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title="">
							<img width="720" height="416" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_3.png" class="attachment-large size-large" alt="" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_3.png 871w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_3-300x173.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/12/ipsec_3-768x444.png 768w" sizes="(max-width: 720px) 100vw, 720px" />								</a>
											</div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
				<section data-id="1af1d90" class="elementor-element elementor-element-1af1d90 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="39e2855" class="elementor-element elementor-element-39e2855 elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="0b641f3" class="elementor-element elementor-element-0b641f3 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #333333;">Jak widać na powyższych zrzutach ekranu z programu Wireshark widzimy tylko pakiety protokołu ESP, które zawierają tylko ESP SPI i ESP Sequence. Czyli ruch jest zaszyfrowany zgodnie z założeniami i z konfiguracją.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			</item>
		<item>
		<title>Skrypt python do zmiany serwerów ntp na CISCO</title>
		<link>https://kubsoo.github.io/rsnet-website/skrypt-python-do-zmiany-serwerow-ntp-na-cisco/</link>
		<comments>https://kubsoo.github.io/rsnet-website/skrypt-python-do-zmiany-serwerow-ntp-na-cisco/#respond</comments>
		<pubDate>Sun, 15 Oct 2017 20:38:08 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[netmiko]]></category>
		<category><![CDATA[ntp]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=602</guid>
		<description><![CDATA[W poniższym wpisie pokażę prosty skrypt w Pythonie wykorzystujący bibliotekę netmiko oraz textfsm. Skrypt będzie łączył sie po ssh ze switchami CISCO i zmieniać adresy serwerów ntp na nowe. Wyobraźmy&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[		<div class="elementor elementor-602">
			<div class="elementor-inner">
				<div class="elementor-section-wrap">
							<section data-id="26968f8" class="elementor-element elementor-element-26968f8 elementor-section-boxed elementor-section-height-default elementor-section-height-default elementor-section elementor-top-section" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
				<div class="elementor-row">
				<div data-id="2ffd70b" class="elementor-element elementor-element-2ffd70b elementor-column elementor-col-100 elementor-top-column" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
					<div class="elementor-widget-wrap">
				<div data-id="3c40220" class="elementor-element elementor-element-3c40220 elementor-widget elementor-widget-text-editor" data-element_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p style="text-align: justify;"><span style="color: #333333;">W poniższym wpisie pokażę prosty skrypt w Pythonie wykorzystujący bibliotekę netmiko oraz textfsm. Skrypt będzie łączył sie po ssh ze switchami CISCO i zmieniać adresy serwerów ntp na nowe.</span></p><p style="text-align: justify;"><span style="color: #333333;">Wyobraźmy sobie sytuację że mamy 20 switchy ze skonfigurowanymi następującymi adresami serwerów ntp:</span></p><pre><span style="color: #333333;">SWITCH-1#show run | in ntp</span><br /><span style="color: #333333;">ntp server 192.168.55.100</span><br /><span style="color: #333333;">ntp server 192.168.60.100</span></pre><p style="text-align: justify;"><span style="color: #333333;">Dostaliśmy informację, że niedługo nastąpi zmiana adresów IP serwerów ntp na nowe następujące adresy:</span></p><p><span style="color: #333333;">10.0.10.1, 10.0.10.2, 10.0.10.3</span></p><p style="text-align: justify;"><span style="color: #333333;">i musimy na wszystkich switchach zamienić adresy serwerów ntp. Możemy to zrobić ręcznie, logując się na każdy switch i wydając komendy:</span></p><p style="text-align: justify;"><span style="color: #333333;"> no ntp server &#8230; </span></p><p style="text-align: justify;"><span style="color: #333333;">ntp server..</span></p><p style="text-align: justify;"><span style="color: #333333;">albo wykorzystać skrypt, który zrobi to za nas. </span></p><p> </p><h5><strong>ZACZYNAMY</strong></h5><p style="text-align: justify;"><span style="color: #333333;">Skrypt realizujący to zadanie będzie działał następująco:</span></p><ol><li><span style="color: #333333;">Logowanie do urządzenia</span></li><li><span style="color: #333333;">Wykonanie komendy show run | in ntp i zapisanie wyników</span></li><li><span style="color: #333333;">Usunięcie starych serwerów ntp z wyników z punktu 2.</span></li><li><span style="color: #333333;">Ustawienie nowych serwerów ntp</span></li></ol><p style="text-align: justify;"><span style="color: #333333;">Skrypt będzie wykorzystywał pliki z komendami, dzięki czemu będziemy mogli go w łatwy sposób przerabiać do innych potrzeb (nie tylko do zmian serwerów ntp). Wystarczy wyedytować  pliki commands.txt i commands2.txt oraz zmienić plik textfsm, który parsuje wyniki polecenia z pliku commands2.txt. Zapraszam do przeczytania moich wpisów o <a href="https://kubsoo.github.io/rsnet-website/cisco-python-netmiko/">Netmiko</a> i <a href="https://kubsoo.github.io/rsnet-website/cisco-cli-textfsm/">TextFSM</a>, które napewno rozjaśnią poniższy skrypt.</span></p><p> </p><p><span style="color: #333333;"><strong>SKRYPT</strong></span></p><p><span style="color: #333333;">config_cisco.py </span></p><pre><span style="color: #333333;">#!/usr/bin/python</span><br /><br /><span style="color: #333333;">from netmiko import ConnectHandler</span><br /><span style="color: #333333;">import sys, textfsm</span><br /><br /><span style="color: #333333;">def check_cmd(ip, username, password,commands):</span><br /><span style="color: #333333;"> # nawiązanie połączenia do urządzenia</span><br /><span style="color: #333333;"> ssh_connection = ConnectHandler(</span><br /><span style="color: #333333;"> device_type='cisco_ios',</span><br /><span style="color: #333333;"> ip=ip,</span><br /><span style="color: #333333;"> username=username,</span><br /><span style="color: #333333;"> password=password,</span><br /><span style="color: #333333;"> )</span><br /><span style="color: #333333;"> result = ""</span><br /><span style="color: #333333;"> for i in commands:</span><br /><span style="color: #333333;">    result += ssh_connection.send_command(i)+"\n"</span><br /><span style="color: #333333;"> # zamknięcie połączenia</span><br /><span style="color: #333333;"> ssh_connection.disconnect()</span><br /><br /><span style="color: #333333;"> return result</span><br /><br /><span style="color: #333333;">def set_cmd(ip, username, password,commands):</span><br /><span style="color: #333333;"> # nawiązanie połączenia do urządzenia</span><br /><span style="color: #333333;"> ssh_connection = ConnectHandler(</span><br /><span style="color: #333333;"> device_type='cisco_ios',</span><br /><span style="color: #333333;"> ip=ip,</span><br /><span style="color: #333333;"> username=username,</span><br /><span style="color: #333333;"> password=password,</span><br /><span style="color: #333333;"> )</span><br /><span style="color: #333333;"> result = ssh_connection.send_config_set(commands)</span><br /><span style="color: #333333;"> # zamknięcie połączenia</span><br /><span style="color: #333333;"> ssh_connection.disconnect()</span><br /><br /><span style="color: #333333;"> return result</span><br /><br /><span style="color: #333333;">if __name__ == "__main__":</span><br /><span style="color: #333333;"> if len(sys.argv) != 4:</span><br /><span style="color: #333333;">   print("\nSkrypt do zmiany adresów serwerów ntp na urzadzeniach cisco:")</span><br /><span style="color: #333333;">   print("\tconfig_cisco.py &lt;device_ip&gt;,&lt;device_ip&gt; &lt;użytkownik&gt; &lt;hasło&gt; \n\n")</span><br /><span style="color: #333333;">   print("\tprzykładowe użycie: config_cisco.py 192.168.10.10,192.168.10.11 admin cisco123 \n\n")</span><br /><span style="color: #333333;">   sys.exit(0)</span><br /><br /><span style="color: #333333;"> devices = sys.argv[1]</span><br /><span style="color: #333333;"> username = sys.argv[2]</span><br /><span style="color: #333333;"> password = sys.argv[3]</span><br /><span style="color: #333333;"> set_file = "commands.txt"</span><br /><span style="color: #333333;"> get_file = "commands2.txt"</span><br /><br /><span style="color: #333333;"> f = open(set_file,'r')</span><br /><span style="color: #333333;"> commands = f.read().splitlines()</span><br /><span style="color: #333333;"> f.close</span><br /><br /><span style="color: #333333;"> f = open(get_file,'r')</span><br /><span style="color: #333333;"> commands2 = f.read().splitlines()</span><br /><span style="color: #333333;"> f.close</span><br /><br /><span style="color: #333333;"> device = devices.split(',')</span><br /><span style="color: #333333;"> re_table = textfsm.TextFSM(open("config_devices.textfsm"))</span><br /><br /><span style="color: #333333;"> for i in switch:</span><br /><span style="color: #333333;">   print "wykonywanie komend z pliku (%s) dla urządzenia %s" %(get_file,i)</span><br /><br /><span style="color: #333333;"> #sprawdzanie czy sa juz jakies ntp servery</span><br /><span style="color: #333333;"> #sprawdzenie odbywa sie przy pomocy komend z pliku get_file</span><br /><span style="color: #333333;"> check_out = check_cmd(i,username,password,commands2)</span><br /><span style="color: #333333;"> fsm_results = re_table.ParseText(check_out)</span><br /><br /><span style="color: #333333;"> commands3=[]</span><br /><span style="color: #333333;"> #sprawdzanie czy juz jest jakis ntp server, jesli jest to go usuwamy</span><br /><span style="color: #333333;"> for j in fsm_results:</span><br /><span style="color: #333333;">   commands3.append('no '+' '.join(j))</span><br /><span style="color: #333333;">   set_out = set_cmd(i,username,password,commands3)</span><br /><br /><span style="color: #333333;"> print "wykonywanie komend z pliku (%s) dla switcha %s" % (set_file,i)</span><br /><span style="color: #333333;"> #ustawienie nowych serwerow ntp, czyli komend z pliku set_file</span><br /><span style="color: #333333;"> set_out = set_cmd(i,username,password,commands)</span><br /><br /><span style="color: #333333;"> #koniec<br /> print "koniec"</span></pre><h5><span style="color: #333333;">Plik config_devices.textfsm</span></h5><pre><span style="color: #333333;">Value ntp (\S+)</span><br /><span style="color: #333333;">Value server (\S+)</span><br /><span style="color: #333333;">Value ip (.+)</span><br /><br /><span style="color: #333333;">Start</span><br /><span style="color: #333333;"> ^${ntp}\s+${server}\s+${ip} -&gt; Record</span></pre><h5><span style="color: #333333;">Pliki z komendami: </span></h5><p><span style="color: #333333;">commands.txt</span></p><pre><span style="color: #333333;">ntp server 10.0.10.1</span><br /><span style="color: #333333;">ntp server 10.0.10.2</span><br /><span style="color: #333333;">ntp server 10.0.10.3</span></pre><p><span style="color: #333333;">commands2.txt</span></p><pre><span style="color: #333333;">show run | in ntp server</span></pre><p><span style="color: #333333;">Skrypt uruchamiamy następującym poleceniem:</span></p><pre style="text-align: justify;"><span style="color: #333333;">config_devices.py 192.168.10.10,192.168.10.11,192.168.10.12,192.168.10.13,192.168.10.14,192.168.10.15,192.168.10.16,192.168.10.17,192.168.10.18,192.168.10.19,192.168.10.20,192.168.10.21,192.168.10.22,192.168.10.23,192.168.10.24,192.168.10.25,192.168.10.26,192.168.10.27,192.168.10.28,192.168.10.29 admin cisco123</span></pre><p style="text-align: justify;"><span style="color: #333333;">Oczywiście skrypt można napisać w inny sposób, nie korzystając z textfsm i plików z komendami, ale chciałem pokazać textfsm, bo uważam że jest to nieodzowna biblioteka przy pracy z urządzeniami Cisco i napewno będę publikował więcej skryptów z jej wykorzystaniem.</span></p></div>
				</div>
				</div>
						</div>
			</div>
		</div>
						</div>
			</div>
		</section>
						</div>
			</div>
		</div>
		]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/skrypt-python-do-zmiany-serwerow-ntp-na-cisco/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>CISCO ISE 2.x monitoring REST API</title>
		<link>https://kubsoo.github.io/rsnet-website/cisco-ise-2-x-monitoring-rest-api/</link>
		<comments>https://kubsoo.github.io/rsnet-website/cisco-ise-2-x-monitoring-rest-api/#respond</comments>
		<pubDate>Tue, 10 Oct 2017 19:58:55 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[ISE]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[rest api]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=446</guid>
		<description><![CDATA[Cisco ISE (Identity Services Engine) pozwala na bezpieczny dostęp urządzeń i użytkowników do sieci przewodowych, bezprzewodowych i do VPN. Więcej informacji na temat możliwości i zastosowań ISE można znaleźć na&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify;">Cisco <a href="https://www.cisco.com/c/en/us/products/security/identity-services-engine/index.html#~stickynav=1" title="">ISE</a> (Identity Services Engine) pozwala na bezpieczny dostęp urządzeń i użytkowników do sieci przewodowych, bezprzewodowych i do VPN. Więcej informacji na temat możliwości i zastosowań ISE można znaleźć na stronie Cisco.com. Ja skupię się na bardzo przydatnej funkcjonalności dostępnej w ISE a mianowicie REST API.</p>
<p style="text-align: justify;">Po podniesieniu wersji ISE z 2.2 do 2.3 napotkałem następujący problem. Po wejściu do interfejsu webowego do głównego menu nie wyświetla się lista aktywnych Endpointów. Mimo iż stacje końcowe są uwierzytelnione do sieci przez ISE.</p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3.png" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-449 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3.png" alt="" width="1182" height="249" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3.png 1182w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3-300x63.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3-768x162.png 768w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_3-1024x216.png 1024w" sizes="(max-width: 1182px) 100vw, 1182px" /></a></p>
<p style="text-align: justify;">Problem można rozwiązać kontaktując się z supportem CISCO, albo skorzystać z dostępnego REST API.</p>
<p style="text-align: justify;">Do sprawdzenia ilości sesji posłużymy się <a href="https://www.cisco.com/c/en/us/td/docs/security/ise/2-0/api_ref_guide/api_ref_book/ise_api_ref_ch1.html" title="">Monitoring REST API</a>. W tym celu musimy najpierw stworzyć użytkownika w jednej z poniższych grup:</p>
<ul>
<li class="pBu1_Bullet1">Super Admin</li>
<li class="pBu1_Bullet1">System Admin</li>
<li class="pBu1_Bullet1">MnT Admin</li>
</ul>
<p style="text-align: justify;">Załóżmy że stworzymy sobie użytkownika mnt_admin w grupie MnT Admin, o haśle Cisco123!</p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1.png" data-rel="lightbox-image-1" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-451 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1.png" alt="" width="1224" height="321" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1.png 1224w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1-300x79.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1-768x201.png 768w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_1-1024x269.png 1024w" sizes="(max-width: 1224px) 100vw, 1224px" /></a></p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_2.png" data-rel="lightbox-image-2" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-452 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_2.png" alt="" width="991" height="779" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_2.png 991w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_2-300x236.png 300w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/ise_2-768x604.png 768w" sizes="(max-width: 991px) 100vw, 991px" /></a></p>
<h4>TEST API</h4>
<p>Teraz możemy przetestować Monitoring REST API wpisując w przeglądarce:</p>
<p>https://&lt;/ ISE-Management-Node &gt;/API/mnt/Session/ActiveList</p>
<p style="text-align: justify;">Pojawi się ekran do logowania. W polu username wpisujemy stworzonego przez nas wcześniej usera: mnt_admin, w polu password hasło: Cisco123!. Po poprawnym uwierzytelnieniu powinniśmy zobaczyć plik xml o postaci:</p>
<pre>&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;activeList noOfActiveSession="226"&gt;
  &lt;activeSession&gt;
    &lt;user_name&gt;00:22:3C:0D:BA:26&lt;/user_name&gt;
    &lt;calling_station_id&gt;00:22:3C:0D:BA:26&lt;/calling_station_id&gt;
    &lt;nas_ip_address&gt;192.168.10.22&lt;/nas_ip_address&gt;
    &lt;acct_session_id&gt;0000001F&lt;/acct_session_id&gt;
    &lt;audit_session_id&gt;0A120A02000000D40135DECF&lt;/audit_session_id&gt;
    &lt;server&gt;ISE01&lt;/server&gt;
    &lt;framed_ip_address&gt;172.16.22.12&lt;/framed_ip_address&gt;
    &lt;framed_ipv6_address/&gt;
  &lt;/activeSession&gt;
  &lt;activeSession&gt;
    &lt;user_name&gt;00:F1:4C:47:B2:27&lt;/user_name&gt;
    &lt;calling_station_id&gt;00:F1:4C:47:B2:27&lt;/calling_station_id&gt;
    &lt;nas_ip_address&gt;192.168.10.22&lt;/nas_ip_address&gt;
    &lt;acct_session_id&gt;00000011&lt;/acct_session_id&gt;
    &lt;audit_session_id&gt;0A120A020000003B004E8945&lt;/audit_session_id&gt;
    &lt;server&gt;ISE01&lt;/server&gt;
    &lt;framed_ip_address&gt;172.16.22.16&lt;/framed_ip_address&gt;
    &lt;framed_ipv6_address/&gt;
  &lt;/activeSession&gt;

…

  &lt;activeSession&gt;
    &lt;user_name&gt;00:14:38:28:A9:12&lt;/user_name&gt;
    &lt;calling_station_id&gt;00:14:38:28:A9:12&lt;/calling_station_id&gt;
    &lt;nas_ip_address&gt;192.168.10.22&lt;/nas_ip_address&gt;
    &lt;acct_session_id&gt;000023B1&lt;/acct_session_id&gt;
    &lt;audit_session_id&gt;0A0C0AED000019DF4879AACD&lt;/audit_session_id&gt;
    &lt;server&gt;ISE01&lt;/server&gt;
    &lt;framed_ip_address&gt;172.16.22.32&lt;/framed_ip_address&gt;
    &lt;framed_ipv6_address/&gt;
  &lt;/activeSession&gt;
  &lt;activeSession&gt;
    &lt;user_name&gt;corp.local/jan.kowalski&lt;/user_name&gt;
    &lt;calling_station_id&gt;EC:F4:BA:17:AB:0D&lt;/calling_station_id&gt;
    &lt;nas_ip_address&gt;192.168.10.22&lt;/nas_ip_address&gt;
    &lt;acct_session_id&gt;00002BDD&lt;/acct_session_id&gt;
    &lt;audit_session_id&gt;0A0B02E200000DA7DF251399&lt;/audit_session_id&gt;
    &lt;server&gt;ISE01&lt;/server&gt;
    &lt;framed_ip_address&gt;172.16.24.12&lt;/framed_ip_address&gt;
    &lt;framed_ipv6_address/&gt;
  &lt;/activeSession&gt;
 &lt;/activeList&gt;</pre>
<p style="text-align: justify;">Wynikiem jest plik XML z kilkoma wartościami dla każdej aktywnej sesji: user_name (nazwa użytkownika), calling_station_id (adres MAC stacji końcowej), nas_ip_address (adres IP urządzenia sieciowego (NAD), do którego podięty jest użytkownik), acct_session_id, audit_session_id, server (instancja ISE do której należy dana sesja) i framed_ip_address (adres IP stacji końcowej)</p>
<p>Druga linijka wyniku zawiera informację o liczbie sesji:</p>
<p><strong>&lt;activeList noOfActiveSession=&#8221;226&#8243;&gt;</strong></p>
<p style="text-align: justify;">Napiszmy teraz skrypt, który oprócz wyświetlenia listy sesji wyświetli też metodę uwierzytelnienia MAB, albo 802.1X.</p>
<h4></h4>
<h4>Skrypt w Pythonie</h4>
<p style="text-align: justify;">Do stworzenia skryptu posłużymy się biblioteką requests, textfsm oraz lxml. Biblioteka requests umożliwi nam połączenie się z API.</p>
<p style="text-align: justify;">Skrypt wygląda następująco:</p>
<pre>#!/usr/bin/python
import requests, textfsm
from lxml import etree

user='mnt_admin'
password='Cisco123!'

r = requests.get('https://&lt;ISE-Management-Node&gt;/admin/API/mnt/Session/ActiveList',auth=(user, password))
utf8_parser = etree.XMLParser(encoding='utf-8')
node = etree.fromstring(r.text.encode('utf-8'), parser=utf8_parser)
xmlstr = etree.tostring(node, xml_declaration=True, encoding="UTF-8", pretty_print=True)

re_table = textfsm.TextFSM(open("ise_sessions.textfsm"))
fsm_results = re_table.ParseText(xmlstr)


total=mab=0
for i in fsm_results:
   total=total+1
   if i[0] == i[1]:
        mab=mab+1

dot1x=total-mab

print "---------------------------------"
print "Sessions per Method"
print "Active Sessions: "+str(total)
print "802.1X Session Count: "+str(dot1x)
print "MAB Session Count: "+str(mab)
print "---------------------------------"</pre>
<p>Plik z szablonem textfsm wygląda następująco:</p>
<pre>Value user_name (\S+)
Value calling_station (\S+)
Value nas_ip_address (\S+)

Start
  ^\s*&lt;activeSession&gt;\s* -&gt; Session

Session
  ^\s*&lt;user_name&gt;${user_name}&lt;\/user_name&gt;
  ^\s*&lt;calling_station_id&gt;${calling_station}&lt;\/calling_station_id&gt;
  ^\s*&lt;nas_ip_address&gt;${nas_ip_address}&lt;\/nas_ip_address&gt; -&gt; Record</pre>
<p>Wynik działania skryptu:</p>
<pre>root@vm01:~# ./ise_api.py

---------------------------------
Sessions per Method
Active Sessions: 226
802.1X Session Count: 85
MAB Session Count: 141
---------------------------------</pre>
<h4>Wyjaśnienie:</h4>
<p style="text-align: justify;">Skrypt wyciąga i zapisuje do tablicy fsm_results następujące informacje dla każdej sesji (username, adres MAC, adres IP). Następnie jest zliczana liczba pozycji w tabeli (total) a w przypadku gdy username = adres MAC, a następuje to w sytuacji gdy uwierzytelniono się do sieci używając MAB (MAC Authentication Bypass). Reszta wyników to uwierzytelnienia przy pomocy 802.1x.</p>
<p style="text-align: justify;">Jak widać liczba aktywnych sesji to 226, a nie tak jak pokazywało WEB GUI 0.</p>
]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/cisco-ise-2-x-monitoring-rest-api/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Czym jest: IP unnumbered ?</title>
		<link>https://kubsoo.github.io/rsnet-website/czym-jest-ip-unnumbered/</link>
		<comments>https://kubsoo.github.io/rsnet-website/czym-jest-ip-unnumbered/#respond</comments>
		<pubDate>Sun, 08 Oct 2017 22:48:59 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Poradnik]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[unnumbered]]></category>

		<guid isPermaLink="false">https://kubsoo.github.io/rsnet-website/?p=467</guid>
		<description><![CDATA[Każdy interfejs routera potrzebuje unikalnego adresu IP, na podstawie którego podejmowane są decyzje o przesłaniu pakietu. W przypadku interfejsów typu point-to-point (np. serial, tunnel) możemy skorzystać z funkcji ip unnumbered&#46;&#46;&#46;]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify;">Każdy interfejs routera potrzebuje unikalnego adresu IP, na podstawie którego podejmowane są decyzje o przesłaniu pakietu. W przypadku interfejsów typu point-to-point (np. serial, tunnel) możemy skorzystać z funkcji ip unnumbered i nie konfigurować bezpośrednio adresu IP na takim interfejsie, a pożyczyć adres IP z innego interfejsu, dzięki czemu zaoszczędzimy adresy, które użylibyśmy do adresacji takich interfejsów. Przed wprowadzaniem <a href="https://pl.wikipedia.org/wiki/VLSM" title="">VLSM</a> (Variable Lenght Subnet Mask) najmniejszą możliwą maską używaną przy protokołach routingu typu <a href="http://www.routeralley.com/guides/classless_classful.pdf" title="">classfull</a> (RIPv1, IGRP) była maska /24, czyli na połączenia point-to-point z dwoma na które potrzebowalibyśmy 2 adresów traciliśmy całą podsieć 254 adresów.</p>
<p style="text-align: justify;">Rozwiązaniem tego problemu było wprowadzenie funkcji <a href="https://www.cisco.com/c/en/us/support/docs/ip/hot-standby-router-protocol-hsrp/13786-20.html" title="">ip unnumbered</a> w urządzeniach sieciowych CISCO. Funkcja ta skonfigurowana na interfejsie typu point-to-point umożliwia pożyczenie adresu IP z innego interfejsu (zazwyczaj korzysta się z interfejsu loopback, ze względu na to iż jest on cały czas podniesiony up/up). Dzięki temu nie trzeba konfigurować interfejsu osobnym adresem IP.</p>
<h4>PRZYKŁAD</h4>
<p style="text-align: justify;">Pokażę teraz przykład użycia funkcji ip unnumbered na interfejsie serial. W poniższym przykładzie mamy dwa routery R1 i R2 połączone ze sobą interfejsem serial. Pomiędzy routerami skonfigurowany jest protokół routingu RIPv1. Na każdym z routerów skonfigurowany został interfejs loopback0 zgodnie z poniższym obrazkiem:</p>
<p><a href="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/unnumbered_1.png" data-rel="lightbox-image-0" data-rl_title="" data-rl_caption="" title=""><img class="aligncenter wp-image-469 size-full" src="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/unnumbered_1.png" alt="" width="404" height="216" srcset="https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/unnumbered_1.png 404w, https://kubsoo.github.io/rsnet-website/wp-content/uploads/2017/10/unnumbered_1-300x160.png 300w" sizes="(max-width: 404px) 100vw, 404px" /></a></p>
<p>Konfiguracja R1:</p>
<pre>interface Loopback0
 ip address 192.168.10.1 255.255.255.0
!
interface Loopback10
 ip address 192.168.100.1 255.255.255.0
!
interface Serial2/0
 ip unnumbered Loopback0
 serial restart-delay 0
!
router rip
 version 1
 network 192.168.10.0
 network 192.168.100.0</pre>
<p>Konfiguracja R2:</p>
<pre>interface Loopback0
 ip address 192.168.20.1 255.255.255.0
!
interface Loopback10
 ip address 192.168.200.1 255.255.255.0
!
interface Serial2/0
 ip unnumbered Loopback0
 serial restart-delay 0
!
router rip
 version 1
 network 192.168.20.0
 network 192.168.200.0</pre>
<p style="text-align: justify;">Z powyższej konfiguracji widać, że na obu routerach interfejsy Serial2/0 zostały zaadresowane poleceniem ip unnumbered Looback0. Sprawdźmy teraz jak wygląda polecenie show ip int brief na obu routerach:</p>
<pre>R1#show ip int brief
Interface IP-Address OK? Method Status Protocol
<strong>Serial2/0 192.168.10.1 YES TFTP up up</strong>
Loopback0 192.168.10.1 YES NVRAM up up
Loopback10 192.168.100.1 YES NVRAM up up</pre>
<pre>R2#show ip int brief
Interface IP-Address OK? Method Status Protocol
<strong>Serial2/0 192.168.20.1 YES TFTP up up</strong>
Loopback0 192.168.20.1 YES NVRAM up up
Loopback10 192.168.200.1 YES NVRAM up up</pre>
<p style="text-align: justify;">Jak widać oba interfejsy Serial2/0 posiadają taki sam adres IP jak interfejsy Loopback0. Sprawdźmy teraz tablicę routingu obu routerów poleceniem: show ip route</p>
<pre>R1#show ip route
...
192.168.10.0/24 is variably subnetted, 2 subnets, 2 masks
C 192.168.10.0/24 is directly connected, Loopback0
L 192.168.10.1/32 is directly connected, Loopback0
R 192.168.20.0/24 [120/1] via 192.168.20.1, 00:00:02, Serial2/0
 192.168.100.0/24 is variably subnetted, 2 subnets, 2 masks
C 192.168.100.0/24 is directly connected, Loopback10
L 192.168.100.1/32 is directly connected, Loopback10
<strong>R 192.168.200.0/24 [120/1] via 192.168.20.1, 00:00:02, Serial2/0</strong></pre>
<pre>R2#show ip route
...
R 192.168.10.0/24 [120/1] via 192.168.10.1, 00:00:29, Serial2/0
 192.168.20.0/24 is variably subnetted, 2 subnets, 2 masks
C 192.168.20.0/24 is directly connected, Loopback0
L 192.168.20.1/32 is directly connected, Loopback0
<strong>R 192.168.100.0/24 [120/1] via 192.168.10.1, 00:00:29, Serial2/0</strong>
 192.168.200.0/24 is variably subnetted, 2 subnets, 2 masks
C 192.168.200.0/24 is directly connected, Loopback100
L 192.168.200.1/32 is directly connected, Loopback100</pre>
<p style="text-align: justify;">Jak widać protokół RIP działa i wskazuje, że adresy 192.168.100.0 i 192.168.200.0 są osiągalne przez interfejsy Serial2/0. Sprawdźmy teraz czy łączność pomiędzy tymi podsieciami istnieje. W tym celu wydajmy na routerze R1 polecenie: ping ip 192.168.200.1 source Loopback10, a na R2 polecenie: ping ip 192.168.100.1 source Loopback10. Czyli będziemy pingować adresy IP intefejsów Loopback10.</p>
<pre>R1#ping 192.168.200.1 source loopback10
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.200.1, timeout is 2 seconds:
Packet sent with a source address of 192.168.100.1
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 12/17/24 ms</pre>
<pre>R2#ping 192.168.100.1 source Loopback10
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.100.1, timeout is 2 seconds:
Packet sent with a source address of 192.168.200.1
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 12/16/20 ms</pre>
<p>Jak widać wszystko działa poprawnie.</p>
<h4></h4>
<h4>PODSUMOWANIE</h4>
<ul>
<li>Funkcja ip unnumbered pozwala zaoszczędzić adresy IPv4 na intefejsach point-to-point</li>
<li>Komenda ip unnumbered może być użyta tylko na interfejsach typu point-to-point</li>
<li>Interfejs z którego &#8222;pożyczany&#8221; jest adres IP musi być podniesiony (status up/up)</li>
</ul>
<p>&nbsp;</p>
]]></content:encoded>
			<wfw:commentRss>https://kubsoo.github.io/rsnet-website/czym-jest-ip-unnumbered/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
